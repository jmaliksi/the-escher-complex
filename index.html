<!doctype html>
<html>
    <head>
        <meta charset="utf8">
        <meta name="viewport" content="width=device-width, initial-scale=0.75">

        <style>
            @media handheld {
                body {
                    font-size: 150%;
                }
            }

            body {
                font-size: 200%;
                background-color: 
hsla(60, 42.00%, 66.00%, 1)
;
                color: 
hsla(240, 42.00%, 25.00%, 1)
;
                overflow: none;
            }

            .body {
                position: absolute;
                top: 0;
                bottom: 1.5em;
                left: 0;
                right: 0;
            }

            .kni-frame {
                position: absolute;
                height: 100%;
                width: 100%;
                overflow-y: scroll;
                transition: transform 1s ease, opacity 1s ease-out;
            }

            .kni-frame-a {
                display: table;
                height: 100%;
                width: 100%;
            }

            .kni-frame-b {
                display: table-cell;
                vertical-align: middle;
                padding: 1em;
                width: 40ex;
            }

            .kni-frame-c {
                display: flex;
                flex-direction: row;
                flex-wrap: nowrap;
                justify-content: center;
                align-items: flex-start;
            }

            .kni-body {
                display: flex-item;
                flex: 0 1 auto;
                max-width: 40ex;
                text-align: justify;
            }

            th {
                vertical-align: top;
                padding-right: 1ex;
            }

            td {
                vertical-align: top;
                cursor: pointer;
            }

            li {
                list-style-type: decimal;
            }

            a {
                color: inherit;
                font-family: 200%;
            }

            a:link {
                color: inherit;
            }

            a:hover {
                color: inherit;
            }

            a:visited {
                color: inherit;
            }

            .reset {
                position: absolute;
                height: 1em;
                bottom: 0;
                left: 0;
                margin: 10px;
            }
        </style>
    </head>
    <body>
        <div class="reset"><a href="#">reset</a></div>
        <script><!--
// @generated
/*eslint semi:[0], no-native-reassign:[0]*/
global = this;
(function (modules) {

    // Bundle allows the run-time to extract already-loaded modules from the
    // boot bundle.
    var bundle = {};
    var main;

    // Unpack module tuples into module objects.
    for (var i = 0; i < modules.length; i++) {
        var module = modules[i];
        module = modules[i] = new Module(
            module[0],
            module[1],
            module[2],
            module[3],
            module[4]
        );
        bundle[module.filename] = module;
    }

    function Module(id, dirname, basename, dependencies, factory) {
        this.id = id;
        this.dirname = dirname;
        this.filename = dirname + "/" + basename;
        // Dependency map and factory are used to instantiate bundled modules.
        this.dependencies = dependencies;
        this.factory = factory;
    }

    Module.prototype._require = function () {
        var module = this;
        if (module.exports === void 0) {
            module.exports = {};
            var require = function (id) {
                var index = module.dependencies[id];
                var dependency = modules[index];
                if (!dependency)
                    throw new Error("Bundle is missing a dependency: " + id);
                return dependency._require();
            };
            require.main = main;
            module.exports = module.factory(
                require,
                module.exports,
                module,
                module.filename,
                module.dirname
            ) || module.exports;
        }
        return module.exports;
    };

    // Communicate the bundle to all bundled modules
    Module.prototype.modules = bundle;

    return function require(filename) {
        main = bundle[filename];
        main._require();
    }
})([["describe.js","kni","describe.js",{},function (require, exports, module, __filename, __dirname){

// kni/describe.js
// ---------------

'use strict';

module.exports = describe;

function describe(node) {
    return types[node.type](node);
}

var types = {};

types.text = function text(node) {
    return node.text;
};

types.echo = function echo(node) {
    return S(node.expression);
};

types.opt = function opt(node) {
    return '(Q ' + node.question.join(' ') + ') (A ' + node.answer.join(' ') + ')';
};

types.goto = function goto(node) {
    return '';
};

types.call = function call(node) {
    return node.label + '(' + node.args.map(S).join(' ') + ') esc ' + node.branch;
};

types.def = function def(node) {
    return '(' + node.locals.join(' ') + ')';
};

types.jump = function jump(node) {
    return node.branch + ' if ' + S(node.condition);
};

types.switch = function _switch(node) {
    var desc = '';
    if (node.variable) {
        desc += '(' + node.variable + '+' +  node.value + ') ' + S(node.expression);
    } else {
        desc += S(node.expression);
    }
    desc += ' (' + node.branches.join(' ') + ') W(' + node.weights.map(S).join(' ') + ')';
    return desc;
};

types.set = function set(node) {
    return node.variable + ' ' + S(node.expression);
};

types.move = function move(node) {
    return S(node.source) + ' -> ' + S(node.target);
};

types.cue = function cue(node) {
    return node.cue;
};

types.br = function br(node) {
    return '';
};

types.par = function par(node) {
    return '';
};

types.rule = function rule(node) {
    return '';
};

types.startJoin = function startJoin(node) {
    return '';
};

types.stopJoin = function stopJoin(node) {
    return '';
};

types.delimit = function delimit(node) {
    return '';
};

types.ask = function ask(node) {
    return '';
};

types.read = function ask(node) {
    var label = node.variable;
    if (node.cue != null) {
        label += ' ' + node.cue;
    }
    return label;
};

function S(args) {
    if (args[0] === 'val' || args[0] === 'get') {
        return args[1];
    } else if (args[0] === 'var') {
        return '(' + args[0] + ' ' + V(args[1], args[2]) + ')';
    } else {
        return '(' + args[0] + ' ' + args.slice(1).map(S).join(' ') + ')';
    }
}

function V(source, target) {
    var r = '';
    for (var i = 0; i < target.length; i++) {
        r += source[i];
        r += '{' + S(target[i]) + '}';
    }
    r += source[i];
    return r;
}

}],["document.js","kni","document.js",{},function (require, exports, module, __filename, __dirname){

// kni/document.js
// ---------------

'use strict';

module.exports = Document;

function Document(element, createPage) {
    var self = this;
    this.document = element.ownerDocument;
    this.parent = element;
    this.frame = null;
    this.body = null;
    this.afterBody = null;
    this.engine = null;
    this.carry = '';
    this.cursor = null;
    this.cursorParent = null;
    this.afterCursor = null;
    this.next = null;
    this.optionIndex = 0;
    this.options = null;
    this.p = false;
    this.br = false;
    this.onclick = onclick;
    this.createPage = createPage || this.createPage;
    function onclick(event) {
        self.answer(event.target.number);
    }
    Object.seal(this);
}

Document.prototype.write = function write(lift, text, drop) {
    var document = this.document;
    lift = this.carry || lift;
    if (this.p) {
        this.cursor = document.createElement("p");
        this.cursorParent.insertBefore(this.cursor, this.afterCursor);
        this.p = false;
        this.br = false;
        lift = '';
    }
    if (this.br) {
        this.cursor.appendChild(document.createElement("br"));
        this.br = false;
        lift = '';
    }
    // TODO merge with prior text node
    this.cursor.appendChild(document.createTextNode(lift + text));
    this.carry = drop;
};

Document.prototype.break = function _break() {
    this.br = true;
};

Document.prototype.paragraph = function paragraph() {
    this.p = true;
};

Document.prototype.startOption = function startOption() {
    this.optionIndex++;
    var document = this.document;
    var tr = document.createElement("tr");
    this.options.appendChild(tr);
    var th = document.createElement("th");
    tr.appendChild(th);
    th.innerText = this.optionIndex + '.';
    var td = document.createElement("td");
    td.number = this.optionIndex;
    td.onclick = this.onclick;
    td.setAttribute("aria-role", "button");
    tr.appendChild(td);
    this.cursor = td;
    this.p = false;
    this.br = false;
    this.carry = '';
};

Document.prototype.stopOption = function stopOption() {
    this.p = false;
    this.br = false;
};

Document.prototype.flush = function flush() {
    // No-op (for console only)
};

Document.prototype.pardon = function pardon() {
    // No-op (for console only)
};

Document.prototype.display = function display() {
    this.frame.style.opacity = 0;
    this.frame.style.transform = 'translateX(2ex)';
    this.parent.appendChild(this.frame);

    // TODO not this
    var frame = this.frame;
    setTimeout(function () {
        frame.style.opacity = 1;
        frame.style.transform = 'translateX(0)';
    }, 10);
};

Document.prototype.clear = function clear() {
    if (this.frame) {
        this.frame.style.opacity = 0;
        this.frame.style.transform = 'translateX(-2ex)';
        this.frame.addEventListener("transitionend", this);
    }
    this.createPage(this.document, this);
    this.cursor = null;
    this.cursorParent = this.body;
    this.afterCursor = this.afterBody;
    this.br = false;
    this.p = true;
    this.carry = '';
    this.optionIndex = 0;
};

Document.prototype.createPage = function createPage(document) {
    this.frame = document.createElement("div");
    this.frame.classList.add("kni-frame");
    this.frame.style.opacity = 0;

    var A = document.createElement("div");
    A.classList.add("kni-frame-a");
    this.frame.appendChild(A);

    var B = document.createElement("div");
    B.classList.add("kni-frame-b");
    A.appendChild(B);

    var C = document.createElement("div");
    C.classList.add("kni-frame-c");
    B.appendChild(C);

    this.body = document.createElement("div");
    this.body.classList.add("kni-body");
    C.appendChild(this.body);

    this.options = document.createElement("table");
    this.body.appendChild(this.options);
    this.afterBody = this.options;
};

Document.prototype.handleEvent = function handleEvent(event) {
    if (event.target.parentNode === this.parent) {
        this.parent.removeChild(event.target);
    }
};

Document.prototype.ask = function ask(cue) {
};

Document.prototype.answer = function answer(text) {
    this.engine.answer(text);
};

Document.prototype.close = function close() {
};

}],["engine.js","kni","engine.js",{"./story":5,"./evaluate":3,"./describe":0},function (require, exports, module, __filename, __dirname){

// kni/engine.js
// -------------

'use strict';

var Story = require('./story');
var evaluate = require('./evaluate');
var describe = require('./describe');

module.exports = Engine;

var debug = typeof process === 'object' && process.env.DEBUG_ENGINE;

function Engine(args) {
    // istanbul ignore next
    var self = this;
    this.story = args.story;
    this.labels = Object.keys(this.story);
    this.handler = args.handler;
    this.options = [];
    this.keywords = {};
    this.noOption = null;
    this.global = new Global(this.handler);
    this.top = this.global;
    // istanbul ignore next
    this.start = args.start || 'start';
    this.label = this.start;
    this.instruction = new Story.constructors.goto(this.start);
    this.render = args.render;
    this.dialog = args.dialog;
    this.dialog.engine = this;
    // istanbul ignore next
    this.randomer = args.randomer || Math;
    this.debug = debug;
    this.waypoint = this.capture();
    Object.seal(this);
}

Engine.prototype.reset = function reset() {
    Engine.call(this, this);
    this.resume();
};

Engine.prototype.continue = function _continue() {
    var _continue;
    do {
        // istanbul ignore if
        if (this.debug) {
            console.log(this.label + ' ' +  this.instruction.type + ' ' + describe(this.instruction));
        }
        // istanbul ignore if
        if (this.instruction == null) {
            // TODO user error for non-console interaction.
            console.log('The label ' + JSON.stringify(this.label) + ' does not exist in this story');
            this.end();
            return;
        }
        // istanbul ignore if
        if (!this['$' + this.instruction.type]) {
            console.error('Unexpected instruction type: ' + this.instruction.type, this.instruction);
            this.resume();
        }
        _continue = this['$' + this.instruction.type](this.instruction);
    } while (_continue);
};

Engine.prototype.goto = function _goto(label) {
    while (this.top != null && (label == 'ESC' || label === 'RET')) {
        // istanbul ignore if
        if (this.debug) {
            console.log(label.toLowerCase());
        }
        if (this.top.stopOption) {
            this.render.stopOption();
        }
        if (label === 'ESC') {
            label = this.top.branch;
        } else {
            label = this.top.next;
        }
        this.top = this.top.parent;
    }

    if (label === 'RET') {
        return this.end();
    }

    var next = this.story[label];
    // istanbul ignore if
    if (!next) {
        console.error('Story missing label', label);
        return this.resume();
    }
    // istanbul ignore if
    if (!next) {
        console.error('Story missing instruction for label: ' + label);
        return this.resume();
    }
    if (this.handler && this.handler.goto) {
        this.handler.goto(label, next);
    }
    this.label = label;
    this.instruction = next;
    return true;
};

Engine.prototype.gothrough = function gothrough(sequence, next) {
    var prev = this.label;
    for (var i = sequence.length - 1; i >= 0; i--) {
        if (next !== 'RET') {
            this.top = new Frame(this.top, [], next, 'RET', prev);
        }
        prev = next;
        next = sequence[i];
    }
    return this.goto(next);
};

Engine.prototype.end = function end() {
    if (this.handler && this.handler.end) {
        this.handler.end(this);
    }
    this.display();
    this.dialog.close();
    return false;
};

Engine.prototype.ask = function ask() {
    if (this.options.length) {
        this.display();
        if (this.handler && this.handler.ask) {
            this.handler.ask(this);
        }
        this.dialog.ask();
    } else if (this.noOption != null) {
        var closure = this.noOption;
        var option = this.story[closure.label];
        this.top = closure.scope;
        var answer = option.answer;
        this.flush();
        this.gothrough(answer, 'RET');
        this.continue();
    } else {
        return this.goto('RET');
    }
};

Engine.prototype.read = function read() {
    this.display();
    if (this.handler && this.handler.ask) {
        this.handler.ask(this);
    }
    this.dialog.ask(this.instruction.cue);
};

Engine.prototype.answer = function answer(text) {
    if (this.handler && this.handler.answer) {
        this.handler.answer(text, this);
    }
    this.render.flush();
    if (this.instruction.type === 'read') {
        this.top.set(this.instruction.variable, text);
        this.render.clear();
        if (this.goto(this.instruction.next)) {
            this.continue();
        }
        return;
    }
    var choice = text - 1;
    if (choice >= 0 && choice < this.options.length) {
        return this.choice(this.options[choice]);
    } else if (this.keywords[text]) {
        return this.choice(this.keywords[text]);
    } else {
        this.render.pardon();
        this.ask();
    }
};

Engine.prototype.choice = function _choice(closure) {
    var option = this.story[closure.label];
    if (this.handler && this.handler.choice) {
        this.handler.choice(option, this);
    }
    this.render.clear();
    this.waypoint = this.capture(closure);
    if (this.handler && this.handler.waypoint) {
        this.handler.waypoint(this.waypoint, this);
    }
    // Resume in the option's closure scope.
    this.top = closure.scope;
    // There is no known case where gothrough would immediately exit for
    // lack of further instructions, so
    // istanbul ignore else
    if (this.gothrough(option.answer, 'RET')) {
        this.flush();
        this.continue();
    }
};

Engine.prototype.display = function display() {
    this.render.display();
};

Engine.prototype.flush = function flush() {
    this.options.length = 0;
    this.noOption = null;
    this.keywords = {};
};

Engine.prototype.write = function write(text) {
    this.render.write(this.instruction.lift, text, this.instruction.drop);
    return this.goto(this.instruction.next);
};

// istanbul ignore next
Engine.prototype.capture = function capture(closure) {
    var label, top;
    if (closure != null) {
        label = closure.label;
        top = closure.scope;
    } else {
        label = this.label;
        top = this.top;
    }

    var stack = [];
    for (; top != this.global; top = top.parent) {
        stack.push(top.capture(this));
    }

    return [
        this.indexOfLabel(label),
        stack,
        this.global.capture(),
        [
            this.randomer._state0U | 0,
            this.randomer._state0L | 0,
            this.randomer._state1U | 0,
            this.randomer._state1L | 0
        ],
    ];
};

// istanbul ignore next
Engine.prototype.resume = function resume(snapshot) {
    this.render.clear();
    this.flush();
    this.label = this.start;
    this.instruction = this.story[this.label];
    this.global = new Global(this.handler);
    this.top = this.global;
    if (snapshot == null) {
        if (this.handler && this.handler.waypoint) {
            this.handler.waypoint(null, this);
        }
        this.continue();
        return;
    }

    // Destructure snapshot
    var label = this.labelOfIndex(snapshot[0]);
    var stack = snapshot[1];
    var global = snapshot[2];
    var random = snapshot[3];

    // Restore globals
    var keys = global[0];
    var values = global[1];
    for (var i = 0; i < keys.length; i++) {
        this.global.set(keys[i], values[i]);
    }

    // Restore stack
    var engine = this;
    this.top = stack.reduceRight(function (parent, snapshot) {
        return Frame.restore(engine, snapshot, parent);
    }, this.global);

    // Restore prng
    this.randomer._state0U = random[0];
    this.randomer._state0L = random[1];
    this.randomer._state1U = random[2];
    this.randomer._state1L = random[3];

    var instruction = this.story[label];
    if (instruction.type === 'opt') {
        if (this.gothrough(instruction.answer, 'RET')) {
            this.flush();
            this.continue();
        }
    } else {
        this.label = label;
        this.flush();
        this.continue();
    }
};

// istanbul ignore next
Engine.prototype.log = function log() {
    this.top.log();
    console.log('');
};

// Here begin the instructions

Engine.prototype.$text = function $text() {
    return this.write(this.instruction.text);
};

Engine.prototype.$echo = function $echo() {
    return this.write('' + evaluate(this.top, this.randomer, this.instruction.expression));
};

Engine.prototype.$br = function $br() {
    this.render.break();
    return this.goto(this.instruction.next);
};

Engine.prototype.$par = function $par() {
    this.render.paragraph();
    return this.goto(this.instruction.next);
};

Engine.prototype.$rule = function $rule() {
    // TODO
    this.render.paragraph();
    return this.goto(this.instruction.next);
};

Engine.prototype.$goto = function $goto() {
    return this.goto(this.instruction.next);
};

Engine.prototype.$call = function $call() {
    var label = this.instruction.label;
    var def = this.story[label];
    // istanbul ignore if
    if (!def) {
        console.error('no such procedure ' + label, this.instruction);
        return this.resume();
    }
    // istanbul ignore if
    if (def.type !== 'def') {
        console.error('Can\'t call non-procedure ' + label, this.instruction);
        return this.resume();
    }
    // istanbul ignore if
    if (def.locals.length !== this.instruction.args.length) {
        console.error('Argument length mismatch for ' + label, this.instruction, procedure);
        return this.resume();
    }
    // TODO replace this.global with closure scope if scoped procedures become
    // viable. This will require that the engine create references to closures
    // when entering a new scope (calling a procedure), in addition to
    // capturing locals. As such the parser will need to retain a reference to
    // the enclosing procedure and note all of the child procedures as they are
    // encountered.
    this.top = new Frame(this.top, def.locals, this.instruction.next, this.instruction.branch, this.label);
    for (var i = 0; i < this.instruction.args.length; i++) {
        var arg = this.instruction.args[i];
        var value = evaluate(this.top.parent, this.randomer, arg);
        this.top.set(def.locals[i], value);
    }
    return this.goto(label);
};

Engine.prototype.$def = function $def() {
    // Procedure argument instructions exist as targets for labels as well as
    // for reference to locals in calls.
    return this.goto(this.instruction.next);
};

Engine.prototype.$opt = function $opt() {
    var closure = new Closure(this.top, this.label);
    for (var i = 0; i < this.instruction.keywords.length; i++) {
        var keyword = this.instruction.keywords[i];
        // The first option to introduce a keyword wins, not the last.
        if (!this.keywords[keyword]) {
            this.keywords[keyword] = closure;
        }
    }
    if (this.instruction.question.length > 0) {
        this.options.push(closure);
        this.render.startOption();
        this.top = new Frame(this.top, [], this.instruction.next, 'RET', this.label, true);
        return this.gothrough(this.instruction.question, 'RET');
    } else if (this.noOption == null) {
        this.noOption = closure;
    }
    return this.goto(this.instruction.next);
};

Engine.prototype.$move = function $move() {
    var value = evaluate(this.top, this.randomer, this.instruction.source);
    var name = evaluate.nominate(this.top, this.randomer, this.instruction.target);
    // istanbul ignore if
    if (this.debug) {
        console.log(this.top.at() + '/' + this.label + ' ' + name + ' = ' + value);
    }
    this.top.set(name, value);
    return this.goto(this.instruction.next);
};

Engine.prototype.$jump = function $jump() {
    var j = this.instruction;
    if (evaluate(this.top, this.randomer, j.condition)) {
        return this.goto(this.instruction.branch);
    } else {
        return this.goto(this.instruction.next);
    }
};

Engine.prototype.$switch = function $switch() {
    var branches = this.instruction.branches.slice();
    var weightExpressions = this.instruction.weights.slice();
    var samples = 1;
    var nexts = [];
    if (this.instruction.mode === 'pick') {
        samples = evaluate(this.top, this.randomer, this.instruction.expression);
    }
    for (var i = 0; i < samples; i++) {
        var value;
        var weights = [];
        var weight = weigh(this.top, this.randomer, weightExpressions, weights);
        if (this.instruction.mode === 'rand' || this.instruction.mode === 'pick') {
            if (weights.length === weight) {
                value = Math.floor(this.randomer.random() * branches.length);
            } else {
                value = pick(weights, weight, this.randomer);
                if (value == null) {
                    break;
                }
            }
        } else {
            value = evaluate(this.top, this.randomer, this.instruction.expression);
            if (this.instruction.variable != null) {
                this.top.set(this.instruction.variable, value + this.instruction.value);
            }
        }
        if (this.instruction.mode === 'loop') {
            // actual modulo, wraps negatives
            value = ((value % branches.length) + branches.length) % branches.length;
        } else if (this.instruction.mode === 'hash') {
            value = evaluate.hash(value) % branches.length;
        }
        value = Math.min(value, branches.length - 1);
        value = Math.max(value, 0);
        var next = branches[value];
        pop(branches, value);
        pop(weightExpressions, value);
        nexts.push(next);
    }
    // istanbul ignore if
    if (this.debug) {
        console.log(this.top.at() + '/' + this.label + ' ' + value + ' -> ' + next);
    }
    return this.gothrough(nexts, this.instruction.next);
};

Engine.prototype.$cue = function $cue() {
    if (this.handler != null && this.handler.cue != null) {
        return this.handler.cue(this.instruction.cue, this.instruction.next, this);
    } else {
        return this.goto(this.instruction.next);
    }
};

function weigh(scope, randomer, expressions, weights) {
    var weight = 0;
    for (var i = 0; i < expressions.length; i++) {
        weights[i] = evaluate(scope, randomer, expressions[i]);
        weight += weights[i];
    }
    return weight;
}

function pick(weights, weight, randomer) {
    var offset = Math.floor(randomer.random() * weight);
    var passed = 0;
    for (var i = 0; i < weights.length; i++) {
        passed += weights[i];
        if (offset < passed) {
            return i;
        }
    }
    return null;
}

function pop(array, index) {
    array[index] = array[array.length - 1];
    array.length--;
}

Engine.prototype.$ask = function $ask() {
    this.ask();
    return false;
};

Engine.prototype.$read = function $read() {
    this.read();
    return false;
};

function Global(handler) {
    this.scope = Object.create(null);
    this.handler = handler;
    this.next = 'RET';
    this.branch = 'RET';
    Object.seal(this);
}

Global.prototype.get = function get(name) {
    if (this.handler && this.handler.has && this.handler.has(name)) {
        return this.handler.get(name);
    } else {
        return this.scope[name] || 0;
    }
};

Global.prototype.set = function set(name, value) {
    if (this.handler && this.handler.has && this.handler.has(name)) {
        this.handler.set(name, value);
    } else {
        this.scope[name] = value;
    }
    if (this.handler && this.handler.changed) {
        this.handler.changed(name, value);
    }
};

// istanbul ignore next
Global.prototype.log = function log() {
    var names = Object.keys(this.scope);
    names.sort();
    for (var i = 0; i < names.length; i++) {
        var name = names[i];
        var value = this.scope[name];
        console.log(name + ' = ' + value);
    }
    console.log('');
};

// istanbul ignore next
Global.prototype.at = function at() {
    return '';
};

Global.prototype.capture = function () {
    var names = Object.keys(this.scope);
    var values = [];
    for (var i = 0; i < names.length; i++) {
        values[i] = this.scope[names[i]] || 0;
    }
    return [names, values];
};

function Frame(parent, locals, next, branch, label, stopOption) {
    this.locals = locals;
    this.scope = Object.create(null);
    for (var i = 0; i < locals.length; i++) {
        this.scope[locals[i]] = 0;
    }
    this.parent = parent;
    this.next = next;
    this.branch = branch;
    this.label = label;
    this.stopOption = stopOption || false;
    Object.seal(this);
}

Frame.prototype.get = function get(name) {
    if (this.locals.indexOf(name) >= 0) {
        return this.scope[name];
    }
    return this.parent.get(name);
};

Frame.prototype.set = function set(name, value) {
    // istanbul ignore else
    if (this.locals.indexOf(name) >= 0) {
        this.scope[name] = value;
        return;
    }
    this.parent.set(name, value);
};

// istanbul ignore next
Frame.prototype.log = function log() {
    this.parent.log();
    console.log('--- ' + this.label + ' -> ' + this.next);
    for (var i = 0; i < this.locals.length; i++) {
        var name = this.locals[i];
        var value = this.scope[name];
        console.log(name + ' = ' + value);
    }
};

// istanbul ignore next
Frame.prototype.at = function at() {
    return this.parent.at() + '/' + this.label;
};

Frame.prototype.capture = function capture(engine) {
    var values = [];
    for (var i = 0; i < this.locals.length; i++) {
        var local = this.locals[i];
        values.push(this.scope[local] || 0);
    }

    return [
        engine.indexOfLabel(this.label),
        engine.indexOfLabel(this.next),
        engine.indexOfLabel(this.branch),
        values,
        +this.stopOption,
    ];
};

Frame.restore = function (engine, snapshot, parent) {
    var label = engine.labelOfIndex(snapshot[0]);
    var next = engine.labelOfIndex(snapshot[1]);
    var branch = engine.labelOfIndex(snapshot[2]);
    var values = snapshot[3];
    var stopOption = Boolean(snapshot[4]);

    var frame = new Frame(parent, [], next, branch, label, stopOption);

    // Technically, not all frames correspond to subroutine calls, but all
    // frames that remain when the engine pauses ought to be.
    // The exceptions would be interstitial frames generated by gothrough,
    // but all of these are exhausted before the engine stops to ask a prompt.
    var call = engine.story[label];
    var def = engine.story[call.label];
    frame.locals = def.locals;
    for (var i = 0; i < values.length; i++) {
        var name = def.locals[i];
        frame.scope[name] = values[i];
    }

    return frame;
};

Engine.prototype.labelOfIndex = function (index) {
    if (index == -2) {
        return 'RET';
    } else if (index === -3) {
        return 'ESC';
    }
    return this.labels[index];
};

Engine.prototype.indexOfLabel = function (label) {
    if (label === 'RET') {
        return -2;
    } else if (label === 'ESC') {
        return -3;
    }
    return this.labels.indexOf(label);
};

function Closure(scope, label) {
    this.scope = scope;
    this.label = label;
    Object.seal(this);
}

}],["evaluate.js","kni","evaluate.js",{},function (require, exports, module, __filename, __dirname){

// kni/evaluate.js
// ---------------

'use strict';

module.exports = evaluate;

function evaluate(scope, randomer, args) {
    var name = args[0];
    if (unary[name] && args.length === 2) {
        return unary[name](
            evaluate(scope, randomer, args[1]),
            scope,
            randomer
        );
    } else if (binary[name] && args.length === 3) {
        return binary[name](
            evaluate(scope, randomer, args[1]),
            evaluate(scope, randomer, args[2]),
            scope,
            randomer
        );
    } else if (name === 'val') {
        return args[1];
    } else if (name === 'get') {
        return scope.get(args[1]);
    // istanbul ignore else
    } else if (name === 'var') {
        return scope.get(nominate(scope, randomer, args));
    } else if (name === 'call') {
        var name = args[1][1];
        var f = functions[name];
        if (!f) {
            // TODO thread line number for containing instruction
            throw new Error('No function named ' + name);
        }
        var values = [];
        for (var i = 2; i < args.length; i++) {
            values.push(evaluate(scope, randomer, args[i]));
        }
        return f.apply(null, values);
    } else {
        throw new Error('Unexpected operator ' + JSON.stringify(args));
    }
}

evaluate.nominate = nominate;
function nominate(scope, randomer, args) {
    if (args[0] === 'get') {
        return args[1];
    }
    var literals = args[1];
    var variables = args[2];
    var name = '';
    for (var i = 0; i < variables.length; i++) {
        name += literals[i] + evaluate(scope, randomer, variables[i]);
    }
    name += literals[i];
    return name;
}

var functions = {
    abs: Math.abs,
    acos: Math.acos,
    asin: Math.asin,
    atan2: Math.atan2,
    atan: Math.atan,
    exp: Math.exp,
    log: Math.log,
    max: Math.max,
    min: Math.min,
    pow: Math.pow,
    sin: Math.sin,
    tan: Math.tan,

    floor: Math.floor,
    ceil: Math.floor,
    round: Math.floor,

    sign: function (x) {
        if (x < 0) {
            return -1;
        }
        if (x > 0) {
            return 1;
        }
        return 0;
    },

    mean: function () {
        var mean = 0;
        for (var i = 0; i < arguments.length; i++) {
            mean += arguments[i];
        }
        return mean / i;
    },

    root: function root(x, y) {
        if (y === 2 || y == null) {
            return Math.sqrt(x);
        }
        return Math.pow(x, 1 / y);
    },

    distance: function distance(x1, y1, x2, y2) {
        return Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
    },

    manhattan: function distance(x1, y1, x2, y2) {
        return Math.abs(x2 - x1, 2) + Math.abs(y2 - y1);
    },

    // TODO parameterize these functions in terms of the expected turns to
    // go from 25% to 75% of capacity, to adjust the rate. This will maybe
    // almost make them understandable.
    //
    // sigmoid: function (steps, cap) {
    //     if (steps === -Infinity) {
    //         return 0;
    //     } else if (steps === Infinity) {
    //         return cap;
    //     } else {
    //         return cap / (1 + Math.pow(Math.E, -steps));
    //     }
    // },

    // diomgis: function (pop, cap) {
    //     if (pop <= 0) {
    //         return -Infinity;
    //     }
    //     var ratio = cap / pop - 1;
    //     if (ratio === 0) {
    //         return Infinity;
    //     }
    //     return -Math.log(ratio, Math.E);
    // },

};

var binary = {
    '+': function (x, y) {
        return x + y;
    },
    '-': function (x, y) {
        return x - y;
    },
    '*': function (x, y) {
        return x * y;
    },
    '/': function (x, y) {
        return (x / y) >> 0;
    },
    '%': function (x, y) {
        return ((x % y) + y) % y;
    },
    '**': function (x, y) {
        return Math.pow(x, y);
    },
    'or': function (x, y) {
        return x || y ? 1 : 0;
    },
    'and': function (x, y) {
        return x && y ? 1 : 0;
    },
    '>=': function (x, y) {
        return x >= y ? 1 : 0;
    },
    '>': function (x, y) {
        return x > y ? 1 : 0;
    },
    '<=': function (x, y) {
        return x <= y ? 1 : 0;
    },
    '<': function (x, y) {
        return x < y ? 1 : 0;
    },
    '==': function (x, y) {
        return x === y ? 1 : 0;
    },
    '<>': function (x, y) {
        return x != y ? 1 : 0;
    },
    '#': function (x, y) {
        return hilbert(x, y);
    },
    '~': function (x, y, scope, randomer) {
        var r = 0;
        for (var i = 0; i < x; i++) {
            r += randomer.random() * y;
        }
        return Math.floor(r);
    }
};

// istanbul ignore next
var unary = {
    'not': function (x) {
        return x ? 0 : 1;
    },
    '-': function (x) {
        return -x;
    },
    '~': function (x, scope, randomer) {
        return Math.floor(randomer.random() * x);
    },
    '#': function (x) {
        return hash(x);
    }
};

// Robert Jenkins's 32 bit hash function
// https://gist.github.com/badboy/6267743
evaluate.hash = hash;
function hash(a) {
    a = (a+0x7ed55d16) + (a<<12);
    a = (a^0xc761c23c) ^ (a>>>19);
    a = (a+0x165667b1) + (a<<5);
    a = (a+0xd3a2646c) ^ (a<<9);
    a = (a+0xfd7046c5) + (a<<3);
    a = (a^0xb55a4f09) ^ (a>>>16);
    return a;
}

// hilbert in range from 0 to 2^32
// x and y in range from 0 to 2^16
// each dimension has origin at 2^15
var dimensionWidth = (-1 >>> 16) + 1;
var halfDimensionWidth = dimensionWidth / 2;
function hilbert(x, y) {
    x += halfDimensionWidth;
    y += halfDimensionWidth;
    var rx = 0;
    var ry = y;
    var scalar = 0;
    for (var scale = dimensionWidth; scale > 0; scale /= 2) {
        rx = x & scale;
        ry = y & scale;
        scalar += scale * ((3 * rx) ^ ry);
        // rotate
        if (!ry) {
            if (rx) {
                x = scale - 1 - x;
                y = scale - 1 - y;
            }
            // transpose
            var t = x;
            x = y;
            y = t;
        }
    }
    return scalar;
}

}],["path.js","kni","path.js",{},function (require, exports, module, __filename, __dirname){

// kni/path.js
// -----------

'use strict';

exports.start = start;

function start() {
    return ['start'];
}

exports.toName = pathToName;

function pathToName(path) {
    var name = path[0];
    var i;
    for (i = 1; i < path.length - 1; i++) {
        name += '.' + path[i];
    }
    var last = path[i];
    if (path.length > 1 && last !== 0) {
        name += '.' + last;
    }
    return name;
}

exports.next = nextPath;

function nextPath(path) {
    path = path.slice();
    path[path.length - 1]++;
    return path;
}

exports.firstChild = firstChildPath;

function firstChildPath(path) {
    path = path.slice();
    path.push(1);
    return path;
}

exports.zerothChild = zerothChildPath;

function zerothChildPath(path) {
    path = path.slice();
    path.push(0);
    return path;
}

}],["story.js","kni","story.js",{"./path":4},function (require, exports, module, __filename, __dirname){

// kni/story.js
// ------------

'use strict';

var Path = require('./path');

var constructors = {};

module.exports = Story;

function Story() {
    this.states = {};
    this.errors = [];
    Object.seal(this);
}

Story.constructors = constructors;

Story.prototype.create = function create(path, type, arg, position) {
    var name = Path.toName(path);
    var Node = constructors[type];
    // istanbul ignore if
    if (!Node) {
        throw new Error('No node constructor for type: ' + type);
    }
    var node = new Node(arg);
    node.position = position;
    this.states[name] = node;
    return node;
};

// istanbul ignore next
Story.prototype.error = function _error(error) {
    this.errors.push(error);
};

constructors.text = Text;
function Text(text) {
    this.type = 'text';
    this.text = text;
    this.lift = ' ';
    this.drop = ' ';
    this.next = 'RET';
    this.position = null;
    Object.seal(this);
}

constructors.echo = Echo;
function Echo(expression) {
    this.type = 'echo';
    this.expression = expression;
    this.lift = '';
    this.drop = '';
    this.next = 'RET';
    this.position = null;
    Object.seal(this);
}

constructors.option = Option;
function Option(label) {
    this.type = 'opt';
    this.question = [];
    this.answer = [];
    this.keywords = null;
    this.next = 'RET';
    this.position = null;
    Object.seal(this);
}

constructors.goto = Goto;
function Goto(next) {
    this.type = 'goto';
    this.next = next;
    this.position = null;
    Object.seal(this);
}

constructors.call = Call;
function Call(label) {
    this.type = 'call';
    this.label = label;
    this.args = null;
    this.next = 'RET';
    this.branch = 'RET';
    this.position = null;
    Object.seal(this);
}

constructors.cue = Cue;
function Cue(cue) {
    this.type = 'cue';
    this.cue = cue;
    this.next = 'RET';
    this.position = null;
    Object.seal(this);
}

constructors.def = Def;
function Def(locals) {
    this.type = 'def';
    this.locals = locals;
    this.next = 'RET';
    this.position = null;
    Object.seal(this);
}

constructors.jump = Jump;
function Jump(condition) {
    this.type = 'jump';
    this.condition = condition;
    this.branch = 'RET';
    this.next = 'RET';
    this.position = null;
    Object.seal(this);
}

constructors.switch = Switch;
function Switch(expression) {
    this.type = 'switch';
    this.expression = expression;
    this.variable = null;
    this.value = 0;
    this.mode = null;
    this.branches = [];
    this.weights = [];
    this.next = 'RET';
    this.position = null;
    Object.seal(this);
}

constructors.move = Move;
function Move() {
    this.type = 'move';
    this.source = null;
    this.target = null;
    this.next = 'RET';
    this.position = null;
    Object.seal(this);
}

constructors.break = Break;
function Break() {
    this.type = 'br';
    this.next = 'RET';
    this.position = null;
    Object.seal(this);
}

constructors.paragraph = Paragraph;
function Paragraph() {
    this.type = 'par';
    this.next = 'RET';
    this.position = null;
    Object.seal(this);
}

constructors.rule = Rule;
function Rule() {
    this.type = 'rule';
    this.next = 'RET';
    this.position = null;
    Object.seal(this);
}

constructors.ask = Ask;
function Ask() {
    this.type = 'ask';
    this.position = null;
    Object.seal(this);
}

constructors.read = Read;
function Read(variable) {
    this.type = 'read';
    this.next = 'RET';
    this.variable = variable;
    this.cue = null;
    this.position = null;
    Object.seal(this);
}

}],["story.json","kni","story.json",{},function (require, exports, module, __filename, __dirname){

// kni/story.json
// --------------

module.exports = module.exports = {
    "start": {
        "type": "par",
        "next": "start.1",
        "position": "snackroom.kni:1:1"
    },
    "start.1": {
        "type": "move",
        "source": [
            "val",
            3
        ],
        "target": [
            "get",
            "currency.0"
        ],
        "next": "start.2",
        "position": "snackroom.kni:2:3"
    },
    "start.2": {
        "type": "move",
        "source": [
            "val",
            3
        ],
        "target": [
            "get",
            "currency.1"
        ],
        "next": "start.3",
        "position": "snackroom.kni:3:3"
    },
    "start.3": {
        "type": "move",
        "source": [
            "val",
            3
        ],
        "target": [
            "get",
            "currency.2"
        ],
        "next": "start.4",
        "position": "snackroom.kni:4:3"
    },
    "start.4": {
        "type": "text",
        "text": "You are in an empty breakroom. Fluorescent light is drowned out by immaterial twilight. Before you are uncountable vending machines.",
        "lift": " ",
        "drop": " ",
        "next": "start.5",
        "position": "snackroom.kni:9:5"
    },
    "start.5": {
        "type": "opt",
        "question": [
            "start.5.2",
            "start.5.3"
        ],
        "answer": [
            "start.5.1",
            "start.5.3",
            "start.5.4"
        ],
        "keywords": [],
        "next": "start.6",
        "position": "snackroom.kni:9:5"
    },
    "start.5.1": {
        "type": "text",
        "text": "You walk up to",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:9:5"
    },
    "start.5.2": {
        "type": "text",
        "text": "Examine",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:9:5"
    },
    "start.5.3": {
        "type": "text",
        "text": "a vending machine.",
        "lift": " ",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:9:5"
    },
    "start.5.4": {
        "type": "par",
        "next": "start.5.5",
        "position": "snackroom.kni:9:5"
    },
    "start.5.5": {
        "type": "call",
        "label": "machine",
        "args": [],
        "next": "start.4",
        "branch": "ESC",
        "position": "snackroom.kni:9:5"
    },
    "start.6": {
        "type": "opt",
        "question": [
            "start.6.2",
            "start.6.3"
        ],
        "answer": [
            "start.6.1",
            "start.6.3",
            "start.6.4"
        ],
        "keywords": [],
        "next": "start.7",
        "position": "snackroom.kni:10:5"
    },
    "start.6.1": {
        "type": "text",
        "text": "You c",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:10:5"
    },
    "start.6.2": {
        "type": "text",
        "text": "C",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:10:5"
    },
    "start.6.3": {
        "type": "text",
        "text": "heck your wallet.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:10:5"
    },
    "start.6.4": {
        "type": "text",
        "text": "Inside you find",
        "lift": " ",
        "drop": " ",
        "next": "start.6.5",
        "position": "snackroom.kni:11:5"
    },
    "start.6.5": {
        "type": "echo",
        "expression": [
            "get",
            "currency.0"
        ],
        "lift": "",
        "drop": "",
        "next": "start.6.6",
        "position": "snackroom.kni:11:5"
    },
    "start.6.6": {
        "type": "text",
        "text": "gold dubloons,",
        "lift": " ",
        "drop": " ",
        "next": "start.6.7",
        "position": "snackroom.kni:11:5"
    },
    "start.6.7": {
        "type": "echo",
        "expression": [
            "get",
            "currency.1"
        ],
        "lift": "",
        "drop": "",
        "next": "start.6.8",
        "position": "snackroom.kni:11:5"
    },
    "start.6.8": {
        "type": "text",
        "text": "small gemstones, and",
        "lift": " ",
        "drop": " ",
        "next": "start.6.9",
        "position": "snackroom.kni:11:5"
    },
    "start.6.9": {
        "type": "echo",
        "expression": [
            "get",
            "currency.2"
        ],
        "lift": "",
        "drop": "",
        "next": "start.6.10",
        "position": "snackroom.kni:11:5"
    },
    "start.6.10": {
        "type": "text",
        "text": "quarters.",
        "lift": " ",
        "drop": " ",
        "next": "start.6.11",
        "position": "snackroom.kni:11:5"
    },
    "start.6.11": {
        "type": "par",
        "next": "start.4",
        "position": "snackroom.kni:11:5"
    },
    "start.7": {
        "type": "opt",
        "question": [
            "start.7.2",
            "start.7.3"
        ],
        "answer": [
            "start.7.1",
            "start.7.3",
            "start.7.4"
        ],
        "keywords": [],
        "next": "start.8",
        "position": "snackroom.kni:12:5"
    },
    "start.7.1": {
        "type": "text",
        "text": "You l",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:12:5"
    },
    "start.7.2": {
        "type": "text",
        "text": "L",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:12:5"
    },
    "start.7.3": {
        "type": "text",
        "text": "eave.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:12:5"
    },
    "start.7.4": {
        "type": "goto",
        "next": "RET",
        "position": "snackroom.kni:12:5"
    },
    "start.8": {
        "type": "ask",
        "position": "snackroom.kni:13:3"
    },
    "machine": {
        "type": "def",
        "locals": [],
        "next": "machine.1",
        "position": "snackroom.kni:15:3"
    },
    "machine.1": {
        "type": "move",
        "source": [
            "~",
            [
                "val",
                3
            ]
        ],
        "target": [
            "get",
            "currency"
        ],
        "next": "machine.2",
        "position": "snackroom.kni:17:3"
    },
    "machine.2": {
        "type": "text",
        "text": "You stand in front of a",
        "lift": "",
        "drop": " ",
        "next": "machine.3",
        "position": "snackroom.kni:18:3"
    },
    "machine.3": {
        "type": "call",
        "label": "color",
        "args": [],
        "next": "machine.4",
        "branch": "RET",
        "position": "snackroom.kni:18:3"
    },
    "machine.4": {
        "type": "text",
        "text": "machine with",
        "lift": " ",
        "drop": " ",
        "next": "machine.5",
        "position": "snackroom.kni:20:3"
    },
    "machine.5": {
        "type": "call",
        "label": "color",
        "args": [],
        "next": "machine.6",
        "branch": "RET",
        "position": "snackroom.kni:20:3"
    },
    "machine.6": {
        "type": "switch",
        "expression": [
            "get",
            "machine.6"
        ],
        "variable": "machine.6",
        "value": 0,
        "mode": "rand",
        "branches": [
            "machine.6.1",
            "machine.6.2",
            "machine.6.3",
            "machine.6.4",
            "machine.6.5",
            "machine.6.6",
            "machine.6.7"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:21:3"
    },
    "machine.6.1": {
        "type": "text",
        "text": "stripes",
        "lift": " ",
        "drop": "",
        "next": "machine.7",
        "position": "snackroom.kni:21:3"
    },
    "machine.6.2": {
        "type": "text",
        "text": "filligry",
        "lift": " ",
        "drop": "",
        "next": "machine.7",
        "position": "snackroom.kni:21:3"
    },
    "machine.6.3": {
        "type": "text",
        "text": "spikes",
        "lift": " ",
        "drop": "",
        "next": "machine.7",
        "position": "snackroom.kni:21:3"
    },
    "machine.6.4": {
        "type": "text",
        "text": "polka dots",
        "lift": " ",
        "drop": "",
        "next": "machine.7",
        "position": "snackroom.kni:21:3"
    },
    "machine.6.5": {
        "type": "text",
        "text": "detailing",
        "lift": " ",
        "drop": "",
        "next": "machine.7",
        "position": "snackroom.kni:21:3"
    },
    "machine.6.6": {
        "type": "text",
        "text": "lettering",
        "lift": " ",
        "drop": "",
        "next": "machine.7",
        "position": "snackroom.kni:21:3"
    },
    "machine.6.7": {
        "type": "text",
        "text": "robot arms",
        "lift": " ",
        "drop": "",
        "next": "machine.7",
        "position": "snackroom.kni:21:3"
    },
    "machine.7": {
        "type": "text",
        "text": ".",
        "lift": "",
        "drop": " ",
        "next": "machine.8",
        "position": "snackroom.kni:22:3"
    },
    "machine.8": {
        "type": "call",
        "label": "contents",
        "args": [
            [
                "get",
                "currency"
            ]
        ],
        "next": "machine.9",
        "branch": "RET",
        "position": "snackroom.kni:22:3"
    },
    "machine.9": {
        "type": "par",
        "next": "machine.10",
        "position": "snackroom.kni:22:3"
    },
    "machine.10": {
        "type": "opt",
        "question": [
            "machine.10.2",
            "machine.10.3"
        ],
        "answer": [
            "machine.10.1",
            "machine.10.3",
            "machine.10.4"
        ],
        "keywords": [],
        "next": "machine.11",
        "position": "snackroom.kni:24:5"
    },
    "machine.10.1": {
        "type": "text",
        "text": "You walk up to",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:24:5"
    },
    "machine.10.2": {
        "type": "text",
        "text": "Examine",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:24:5"
    },
    "machine.10.3": {
        "type": "text",
        "text": "another vending machine.",
        "lift": " ",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:24:5"
    },
    "machine.10.4": {
        "type": "goto",
        "next": "machine",
        "position": "snackroom.kni:24:5"
    },
    "machine.11": {
        "type": "opt",
        "question": [
            "machine.11.2",
            "machine.11.3"
        ],
        "answer": [
            "machine.11.1",
            "machine.11.3",
            "machine.11.4"
        ],
        "keywords": [],
        "next": "machine.12",
        "position": "snackroom.kni:25:5"
    },
    "machine.11.1": {
        "type": "text",
        "text": "You s",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:25:5"
    },
    "machine.11.2": {
        "type": "text",
        "text": "S",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:25:5"
    },
    "machine.11.3": {
        "type": "text",
        "text": "tep away.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:25:5"
    },
    "machine.11.4": {
        "type": "move",
        "source": [
            "val",
            0
        ],
        "target": [
            "get",
            "seen.machine"
        ],
        "next": "RET",
        "position": "snackroom.kni:25:5"
    },
    "machine.12": {
        "type": "ask",
        "position": "snackroom.kni:26:3"
    },
    "show.money": {
        "type": "def",
        "locals": [
            "currency"
        ],
        "next": "show.money.1",
        "position": "snackroom.kni:28:3"
    },
    "show.money.1": {
        "type": "text",
        "text": "This machine takes",
        "lift": " ",
        "drop": " ",
        "next": "show.money.2",
        "position": "snackroom.kni:29:3"
    },
    "show.money.2": {
        "type": "switch",
        "expression": [
            "get",
            "currency"
        ],
        "variable": null,
        "value": 0,
        "mode": "walk",
        "branches": [
            "show.money.2.1",
            "show.money.2.2",
            "show.money.2.3"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:29:3"
    },
    "show.money.2.1": {
        "type": "text",
        "text": "gold dubloons",
        "lift": "",
        "drop": "",
        "next": "show.money.3",
        "position": "snackroom.kni:29:3"
    },
    "show.money.2.2": {
        "type": "text",
        "text": "gemstones",
        "lift": "",
        "drop": "",
        "next": "show.money.3",
        "position": "snackroom.kni:29:3"
    },
    "show.money.2.3": {
        "type": "text",
        "text": "quarters",
        "lift": "",
        "drop": "",
        "next": "show.money.3",
        "position": "snackroom.kni:29:3"
    },
    "show.money.3": {
        "type": "text",
        "text": ". You have",
        "lift": "",
        "drop": " ",
        "next": "show.money.4",
        "position": "snackroom.kni:29:3"
    },
    "show.money.4": {
        "type": "echo",
        "expression": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "lift": "",
        "drop": "",
        "next": "show.money.5",
        "position": "snackroom.kni:29:3"
    },
    "show.money.5": {
        "type": "switch",
        "expression": [
            "get",
            "currency"
        ],
        "variable": null,
        "value": 0,
        "mode": "walk",
        "branches": [
            "show.money.5.1",
            "show.money.5.2",
            "show.money.5.3"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:29:3"
    },
    "show.money.5.1": {
        "type": "text",
        "text": "dubloons",
        "lift": " ",
        "drop": "",
        "next": "show.money.6",
        "position": "snackroom.kni:29:3"
    },
    "show.money.5.2": {
        "type": "text",
        "text": "gemstones",
        "lift": " ",
        "drop": "",
        "next": "show.money.6",
        "position": "snackroom.kni:29:3"
    },
    "show.money.5.3": {
        "type": "text",
        "text": "quarters",
        "lift": " ",
        "drop": "",
        "next": "show.money.6",
        "position": "snackroom.kni:29:3"
    },
    "show.money.6": {
        "type": "text",
        "text": ".",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:30:3"
    },
    "color": {
        "type": "def",
        "locals": [],
        "next": "color.1",
        "position": "snackroom.kni:31:3"
    },
    "color.1": {
        "type": "switch",
        "expression": [
            "get",
            "color.1"
        ],
        "variable": "color.1",
        "value": 0,
        "mode": "rand",
        "branches": [
            "color.1.1",
            "color.1.2",
            "color.1.3",
            "color.1.4",
            "color.1.5",
            "color.1.6",
            "color.1.7",
            "color.1.8",
            "color.1.9",
            "color.1.10",
            "color.1.11",
            "color.1.12",
            "color.1.13",
            "color.1.14",
            "color.1.15",
            "color.1.16"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:32:3"
    },
    "color.1.1": {
        "type": "text",
        "text": "red",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:32:3"
    },
    "color.1.2": {
        "type": "text",
        "text": "green",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:32:3"
    },
    "color.1.3": {
        "type": "text",
        "text": "blue",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:32:3"
    },
    "color.1.4": {
        "type": "text",
        "text": "black",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:32:3"
    },
    "color.1.5": {
        "type": "text",
        "text": "yellow",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:32:3"
    },
    "color.1.6": {
        "type": "text",
        "text": "gray",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:32:3"
    },
    "color.1.7": {
        "type": "text",
        "text": "white",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:32:3"
    },
    "color.1.8": {
        "type": "text",
        "text": "gold",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:32:3"
    },
    "color.1.9": {
        "type": "text",
        "text": "purple",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:32:3"
    },
    "color.1.10": {
        "type": "text",
        "text": "silver",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:32:3"
    },
    "color.1.11": {
        "type": "text",
        "text": "chrome",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:32:3"
    },
    "color.1.12": {
        "type": "text",
        "text": "glowing",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:32:3"
    },
    "color.1.13": {
        "type": "text",
        "text": "rose gold",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:32:3"
    },
    "color.1.14": {
        "type": "text",
        "text": "scarlet",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:32:3"
    },
    "color.1.15": {
        "type": "text",
        "text": "amethyst",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:32:3"
    },
    "color.1.16": {
        "type": "text",
        "text": "tourmaline",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:32:3"
    },
    "contents": {
        "type": "def",
        "locals": [
            "currency"
        ],
        "next": "contents.1",
        "position": "snackroom.kni:34:3"
    },
    "contents.1": {
        "type": "switch",
        "expression": [
            "get",
            "contents.1"
        ],
        "variable": "contents.1",
        "value": 0,
        "mode": "rand",
        "branches": [
            "contents.1.1",
            "contents.1.2",
            "contents.1.3"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:35:3"
    },
    "contents.1.1": {
        "type": "text",
        "text": "Behind a",
        "lift": "",
        "drop": " ",
        "next": "contents.1.1.1",
        "position": "snackroom.kni:35:3"
    },
    "contents.1.1.1": {
        "type": "switch",
        "expression": [
            "get",
            "contents.1.1.1"
        ],
        "variable": "contents.1.1.1",
        "value": 0,
        "mode": "rand",
        "branches": [
            "contents.1.1.1.1",
            "contents.1.1.1.2",
            "contents.1.1.1.3",
            "contents.1.1.1.4"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:35:3"
    },
    "contents.1.1.1.1": {
        "type": "text",
        "text": "short",
        "lift": "",
        "drop": "",
        "next": "contents.1.1.2",
        "position": "snackroom.kni:35:3"
    },
    "contents.1.1.1.2": {
        "type": "text",
        "text": "tall",
        "lift": "",
        "drop": "",
        "next": "contents.1.1.2",
        "position": "snackroom.kni:35:3"
    },
    "contents.1.1.1.3": {
        "type": "text",
        "text": "clean",
        "lift": "",
        "drop": "",
        "next": "contents.1.1.2",
        "position": "snackroom.kni:35:3"
    },
    "contents.1.1.1.4": {
        "type": "text",
        "text": "polished",
        "lift": "",
        "drop": "",
        "next": "contents.1.1.2",
        "position": "snackroom.kni:35:3"
    },
    "contents.1.1.2": {
        "type": "text",
        "text": "glass panel,",
        "lift": " ",
        "drop": " ",
        "next": "contents.2",
        "position": "snackroom.kni:36:5"
    },
    "contents.1.2": {
        "type": "text",
        "text": "On",
        "lift": "",
        "drop": " ",
        "next": "contents.1.2.1",
        "position": "snackroom.kni:36:5"
    },
    "contents.1.2.1": {
        "type": "switch",
        "expression": [
            "get",
            "contents.1.2.1"
        ],
        "variable": "contents.1.2.1",
        "value": 0,
        "mode": "rand",
        "branches": [
            "contents.1.2.1.1",
            "contents.1.2.1.2",
            "contents.1.2.1.3"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:36:5"
    },
    "contents.1.2.1.1": {
        "type": "text",
        "text": "simple",
        "lift": "",
        "drop": "",
        "next": "contents.1.2.2",
        "position": "snackroom.kni:36:5"
    },
    "contents.1.2.1.2": {
        "type": "text",
        "text": "colorful",
        "lift": "",
        "drop": "",
        "next": "contents.1.2.2",
        "position": "snackroom.kni:36:5"
    },
    "contents.1.2.1.3": {
        "type": "text",
        "text": "digital",
        "lift": "",
        "drop": "",
        "next": "contents.1.2.2",
        "position": "snackroom.kni:36:5"
    },
    "contents.1.2.2": {
        "type": "text",
        "text": "labels,",
        "lift": " ",
        "drop": " ",
        "next": "contents.2",
        "position": "snackroom.kni:37:5"
    },
    "contents.1.3": {
        "type": "switch",
        "expression": [
            "get",
            "contents.1.3"
        ],
        "variable": "contents.1.3",
        "value": 0,
        "mode": "rand",
        "branches": [
            "contents.1.3.0.1",
            "contents.1.3.0.2",
            "contents.1.3.0.3"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:37:5"
    },
    "contents.1.3.0.1": {
        "type": "text",
        "text": "Floating",
        "lift": "",
        "drop": "",
        "next": "contents.1.3.1",
        "position": "snackroom.kni:37:5"
    },
    "contents.1.3.0.2": {
        "type": "text",
        "text": "Dancing",
        "lift": "",
        "drop": "",
        "next": "contents.1.3.1",
        "position": "snackroom.kni:37:5"
    },
    "contents.1.3.0.3": {
        "type": "text",
        "text": "Arrayed",
        "lift": "",
        "drop": "",
        "next": "contents.1.3.1",
        "position": "snackroom.kni:37:5"
    },
    "contents.1.3.1": {
        "type": "text",
        "text": "on an LCD screen,",
        "lift": " ",
        "drop": " ",
        "next": "contents.2",
        "position": "snackroom.kni:38:3"
    },
    "contents.2": {
        "type": "text",
        "text": "you see options for",
        "lift": " ",
        "drop": " ",
        "next": "contents.3",
        "position": "snackroom.kni:39:3"
    },
    "contents.3": {
        "type": "switch",
        "expression": [
            "get",
            "contents.3"
        ],
        "variable": "contents.3",
        "value": 0,
        "mode": "rand",
        "branches": [
            "contents.3.1",
            "contents.3.2",
            "contents.3.3",
            "contents.3.4",
            "contents.3.5",
            "contents.3.6",
            "contents.3.7",
            "contents.3.8"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:40:5"
    },
    "contents.3.1": {
        "type": "call",
        "label": "option.coffee",
        "args": [
            [
                "get",
                "currency"
            ]
        ],
        "next": "RET",
        "branch": "RET",
        "position": "snackroom.kni:40:5"
    },
    "contents.3.2": {
        "type": "call",
        "label": "option.pizza",
        "args": [
            [
                "get",
                "currency"
            ]
        ],
        "next": "RET",
        "branch": "RET",
        "position": "snackroom.kni:41:5"
    },
    "contents.3.3": {
        "type": "call",
        "label": "option.fanta",
        "args": [
            [
                "get",
                "currency"
            ]
        ],
        "next": "RET",
        "branch": "RET",
        "position": "snackroom.kni:42:5"
    },
    "contents.3.4": {
        "type": "call",
        "label": "option.bento",
        "args": [
            [
                "get",
                "currency"
            ]
        ],
        "next": "RET",
        "branch": "RET",
        "position": "snackroom.kni:43:5"
    },
    "contents.3.5": {
        "type": "call",
        "label": "option.money",
        "args": [
            [
                "get",
                "currency"
            ]
        ],
        "next": "RET",
        "branch": "RET",
        "position": "snackroom.kni:44:5"
    },
    "contents.3.6": {
        "type": "call",
        "label": "option.dippindots",
        "args": [
            [
                "get",
                "currency"
            ]
        ],
        "next": "RET",
        "branch": "RET",
        "position": "snackroom.kni:45:5"
    },
    "contents.3.7": {
        "type": "call",
        "label": "option.tea",
        "args": [
            [
                "get",
                "currency"
            ]
        ],
        "next": "RET",
        "branch": "RET",
        "position": "snackroom.kni:46:5"
    },
    "contents.3.8": {
        "type": "call",
        "label": "option.healthy",
        "args": [
            [
                "get",
                "currency"
            ]
        ],
        "next": "RET",
        "branch": "RET",
        "position": "snackroom.kni:47:5"
    },
    "option.coffee": {
        "type": "def",
        "locals": [
            "currency"
        ],
        "next": "option.coffee.1",
        "position": "snackroom.kni:50:3"
    },
    "option.coffee.1": {
        "type": "text",
        "text": "coffee.",
        "lift": " ",
        "drop": " ",
        "next": "option.coffee.2",
        "position": "snackroom.kni:51:3"
    },
    "option.coffee.2": {
        "type": "par",
        "next": "option.coffee.3",
        "position": "snackroom.kni:51:3"
    },
    "option.coffee.3": {
        "type": "call",
        "label": "show.money",
        "args": [
            [
                "get",
                "currency"
            ]
        ],
        "next": "option.coffee.4",
        "branch": "ESC",
        "position": "snackroom.kni:52:3"
    },
    "option.coffee.4": {
        "type": "switch",
        "expression": [
            "not",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ]
        ],
        "variable": null,
        "value": 0,
        "mode": "walk",
        "branches": [
            "option.coffee.4.1",
            "option.coffee.4.2"
        ],
        "weights": [
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:53:3"
    },
    "option.coffee.4.1": {
        "type": "opt",
        "question": [
            "option.coffee.4.1.0.2",
            "option.coffee.4.1.0.3"
        ],
        "answer": [
            "option.coffee.4.1.0.1",
            "option.coffee.4.1.0.3",
            "option.coffee.4.1.0.4"
        ],
        "keywords": [],
        "next": "option.coffee.4.1.1",
        "position": "snackroom.kni:54:7"
    },
    "option.coffee.4.1.0.1": {
        "type": "text",
        "text": "You purchase a d",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:54:7"
    },
    "option.coffee.4.1.0.2": {
        "type": "text",
        "text": "D",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:54:7"
    },
    "option.coffee.4.1.0.3": {
        "type": "text",
        "text": "ark roast.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:54:7"
    },
    "option.coffee.4.1.0.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.coffee.4.1.0.5",
        "position": "snackroom.kni:55:7"
    },
    "option.coffee.4.1.0.5": {
        "type": "call",
        "label": "coffee.flavor",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:55:7"
    },
    "option.coffee.4.1.1": {
        "type": "opt",
        "question": [
            "option.coffee.4.1.1.2",
            "option.coffee.4.1.1.3"
        ],
        "answer": [
            "option.coffee.4.1.1.1",
            "option.coffee.4.1.1.3",
            "option.coffee.4.1.1.4"
        ],
        "keywords": [],
        "next": "option.coffee.4.1.2",
        "position": "snackroom.kni:56:7"
    },
    "option.coffee.4.1.1.1": {
        "type": "text",
        "text": "You purchase a m",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:56:7"
    },
    "option.coffee.4.1.1.2": {
        "type": "text",
        "text": "M",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:56:7"
    },
    "option.coffee.4.1.1.3": {
        "type": "text",
        "text": "edium roast.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:56:7"
    },
    "option.coffee.4.1.1.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.coffee.4.1.1.5",
        "position": "snackroom.kni:57:7"
    },
    "option.coffee.4.1.1.5": {
        "type": "call",
        "label": "coffee.flavor",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:57:7"
    },
    "option.coffee.4.1.2": {
        "type": "opt",
        "question": [
            "option.coffee.4.1.2.2",
            "option.coffee.4.1.2.3"
        ],
        "answer": [
            "option.coffee.4.1.2.1",
            "option.coffee.4.1.2.3",
            "option.coffee.4.1.2.4"
        ],
        "keywords": [],
        "next": "option.coffee.4.1.3",
        "position": "snackroom.kni:58:7"
    },
    "option.coffee.4.1.2.1": {
        "type": "text",
        "text": "You purchase a l",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:58:7"
    },
    "option.coffee.4.1.2.2": {
        "type": "text",
        "text": "L",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:58:7"
    },
    "option.coffee.4.1.2.3": {
        "type": "text",
        "text": "ight roast.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:58:7"
    },
    "option.coffee.4.1.2.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.coffee.4.1.2.5",
        "position": "snackroom.kni:59:7"
    },
    "option.coffee.4.1.2.5": {
        "type": "call",
        "label": "coffee.flavor",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:59:7"
    },
    "option.coffee.4.1.3": {
        "type": "opt",
        "question": [
            "option.coffee.4.1.3.2",
            "option.coffee.4.1.3.3"
        ],
        "answer": [
            "option.coffee.4.1.3.1",
            "option.coffee.4.1.3.3",
            "option.coffee.4.1.3.4"
        ],
        "keywords": [],
        "next": "option.coffee.4.1.4",
        "position": "snackroom.kni:60:7"
    },
    "option.coffee.4.1.3.1": {
        "type": "text",
        "text": "You purchase a l",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:60:7"
    },
    "option.coffee.4.1.3.2": {
        "type": "text",
        "text": "L",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:60:7"
    },
    "option.coffee.4.1.3.3": {
        "type": "text",
        "text": "atte.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:60:7"
    },
    "option.coffee.4.1.3.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.coffee.4.1.3.5",
        "position": "snackroom.kni:61:7"
    },
    "option.coffee.4.1.3.5": {
        "type": "text",
        "text": "The warm milk lulls you into a",
        "lift": " ",
        "drop": " ",
        "next": "option.coffee.4.1.3.6",
        "position": "snackroom.kni:62:7"
    },
    "option.coffee.4.1.3.6": {
        "type": "switch",
        "expression": [
            "get",
            "option.coffee.4.1.3.6"
        ],
        "variable": "option.coffee.4.1.3.6",
        "value": 0,
        "mode": "rand",
        "branches": [
            "option.coffee.4.1.3.6.1",
            "option.coffee.4.1.3.6.2"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:62:7"
    },
    "option.coffee.4.1.3.6.1": {
        "type": "text",
        "text": "false",
        "lift": "",
        "drop": "",
        "next": "option.coffee.4.1.3.7",
        "position": "snackroom.kni:62:7"
    },
    "option.coffee.4.1.3.6.2": {
        "type": "goto",
        "next": "option.coffee.4.1.3.7",
        "position": "snackroom.kni:62:7"
    },
    "option.coffee.4.1.3.7": {
        "type": "text",
        "text": "sense of security.",
        "lift": " ",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:63:7"
    },
    "option.coffee.4.1.4": {
        "type": "opt",
        "question": [
            "option.coffee.4.1.4.2",
            "option.coffee.4.1.4.3"
        ],
        "answer": [
            "option.coffee.4.1.4.1",
            "option.coffee.4.1.4.3",
            "option.coffee.4.1.4.4"
        ],
        "keywords": [],
        "next": "RET",
        "position": "snackroom.kni:63:7"
    },
    "option.coffee.4.1.4.1": {
        "type": "text",
        "text": "You purchase a h",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:63:7"
    },
    "option.coffee.4.1.4.2": {
        "type": "text",
        "text": "H",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:63:7"
    },
    "option.coffee.4.1.4.3": {
        "type": "text",
        "text": "ot cocoa.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:63:7"
    },
    "option.coffee.4.1.4.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.coffee.4.1.4.5",
        "position": "snackroom.kni:64:7"
    },
    "option.coffee.4.1.4.5": {
        "type": "text",
        "text": "It's",
        "lift": " ",
        "drop": " ",
        "next": "option.coffee.4.1.4.6",
        "position": "snackroom.kni:65:7"
    },
    "option.coffee.4.1.4.6": {
        "type": "switch",
        "expression": [
            "get",
            "option.coffee.4.1.4.6"
        ],
        "variable": "option.coffee.4.1.4.6",
        "value": 0,
        "mode": "rand",
        "branches": [
            "option.coffee.4.1.4.6.1",
            "option.coffee.4.1.4.6.2",
            "option.coffee.4.1.4.6.3",
            "option.coffee.4.1.4.6.4"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:65:7"
    },
    "option.coffee.4.1.4.6.1": {
        "type": "text",
        "text": "rather",
        "lift": "",
        "drop": "",
        "next": "option.coffee.4.1.4.7",
        "position": "snackroom.kni:65:7"
    },
    "option.coffee.4.1.4.6.2": {
        "type": "text",
        "text": "too",
        "lift": "",
        "drop": "",
        "next": "option.coffee.4.1.4.7",
        "position": "snackroom.kni:65:7"
    },
    "option.coffee.4.1.4.6.3": {
        "type": "text",
        "text": "pleasantly",
        "lift": "",
        "drop": "",
        "next": "option.coffee.4.1.4.7",
        "position": "snackroom.kni:65:7"
    },
    "option.coffee.4.1.4.6.4": {
        "type": "text",
        "text": "not too",
        "lift": "",
        "drop": "",
        "next": "option.coffee.4.1.4.7",
        "position": "snackroom.kni:65:7"
    },
    "option.coffee.4.1.4.7": {
        "type": "text",
        "text": "sweet.",
        "lift": " ",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:66:3"
    },
    "option.coffee.4.2": {
        "type": "goto",
        "next": "RET",
        "position": "snackroom.kni:66:3"
    },
    "coffee.flavor": {
        "type": "def",
        "locals": [],
        "next": "coffee.flavor.1",
        "position": "snackroom.kni:68:5"
    },
    "coffee.flavor.1": {
        "type": "text",
        "text": "It has",
        "lift": " ",
        "drop": " ",
        "next": "coffee.flavor.2",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.2": {
        "type": "switch",
        "expression": [
            "get",
            "coffee.flavor.2"
        ],
        "variable": "coffee.flavor.2",
        "value": 0,
        "mode": "rand",
        "branches": [
            "coffee.flavor.2.1",
            "coffee.flavor.2.2",
            "coffee.flavor.2.3",
            "coffee.flavor.2.4"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.2.1": {
        "type": "text",
        "text": "heavy",
        "lift": "",
        "drop": " ",
        "next": "coffee.flavor.3",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.2.2": {
        "type": "text",
        "text": "light",
        "lift": "",
        "drop": " ",
        "next": "coffee.flavor.3",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.2.3": {
        "type": "goto",
        "next": "coffee.flavor.3",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.2.4": {
        "type": "goto",
        "next": "coffee.flavor.3",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.3": {
        "type": "switch",
        "expression": [
            "get",
            "coffee.flavor.3"
        ],
        "variable": "coffee.flavor.3",
        "value": 0,
        "mode": "rand",
        "branches": [
            "coffee.flavor.3.1",
            "coffee.flavor.3.2"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.3.1": {
        "type": "text",
        "text": "hints",
        "lift": "",
        "drop": "",
        "next": "coffee.flavor.4",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.3.2": {
        "type": "text",
        "text": "notes",
        "lift": "",
        "drop": "",
        "next": "coffee.flavor.4",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.4": {
        "type": "text",
        "text": "of",
        "lift": " ",
        "drop": " ",
        "next": "coffee.flavor.5",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.5": {
        "type": "switch",
        "expression": [
            "get",
            "coffee.flavor.5"
        ],
        "variable": "coffee.flavor.5",
        "value": 0,
        "mode": "rand",
        "branches": [
            "coffee.flavor.5.1",
            "coffee.flavor.5.2",
            "coffee.flavor.5.3",
            "coffee.flavor.5.4",
            "coffee.flavor.5.5",
            "coffee.flavor.5.6",
            "coffee.flavor.5.7",
            "coffee.flavor.5.8",
            "coffee.flavor.5.9",
            "coffee.flavor.5.10",
            "coffee.flavor.5.11",
            "coffee.flavor.5.12",
            "coffee.flavor.5.13"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.5.1": {
        "type": "text",
        "text": "forgotten memories",
        "lift": "",
        "drop": "",
        "next": "coffee.flavor.6",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.5.2": {
        "type": "text",
        "text": "hazelnut",
        "lift": "",
        "drop": "",
        "next": "coffee.flavor.6",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.5.3": {
        "type": "text",
        "text": "chocolate",
        "lift": "",
        "drop": "",
        "next": "coffee.flavor.6",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.5.4": {
        "type": "text",
        "text": "caramel",
        "lift": "",
        "drop": "",
        "next": "coffee.flavor.6",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.5.5": {
        "type": "text",
        "text": "doom",
        "lift": "",
        "drop": "",
        "next": "coffee.flavor.6",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.5.6": {
        "type": "text",
        "text": "blood",
        "lift": "",
        "drop": "",
        "next": "coffee.flavor.6",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.5.7": {
        "type": "text",
        "text": "night",
        "lift": "",
        "drop": "",
        "next": "coffee.flavor.6",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.5.8": {
        "type": "text",
        "text": "sunshine",
        "lift": "",
        "drop": "",
        "next": "coffee.flavor.6",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.5.9": {
        "type": "text",
        "text": "acidity",
        "lift": "",
        "drop": "",
        "next": "coffee.flavor.6",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.5.10": {
        "type": "text",
        "text": "percolation",
        "lift": "",
        "drop": "",
        "next": "coffee.flavor.6",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.5.11": {
        "type": "text",
        "text": "brimstone",
        "lift": "",
        "drop": "",
        "next": "coffee.flavor.6",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.5.12": {
        "type": "text",
        "text": "velvet",
        "lift": "",
        "drop": "",
        "next": "coffee.flavor.6",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.5.13": {
        "type": "text",
        "text": "leather",
        "lift": "",
        "drop": "",
        "next": "coffee.flavor.6",
        "position": "snackroom.kni:69:5"
    },
    "coffee.flavor.6": {
        "type": "text",
        "text": ".",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:70:5"
    },
    "option.fanta": {
        "type": "def",
        "locals": [
            "currency"
        ],
        "next": "option.fanta.1",
        "position": "snackroom.kni:71:3"
    },
    "option.fanta.1": {
        "type": "text",
        "text": "fanta.",
        "lift": " ",
        "drop": " ",
        "next": "option.fanta.2",
        "position": "snackroom.kni:72:3"
    },
    "option.fanta.2": {
        "type": "par",
        "next": "option.fanta.3",
        "position": "snackroom.kni:72:3"
    },
    "option.fanta.3": {
        "type": "call",
        "label": "show.money",
        "args": [
            [
                "get",
                "currency"
            ]
        ],
        "next": "option.fanta.4",
        "branch": "ESC",
        "position": "snackroom.kni:73:3"
    },
    "option.fanta.4": {
        "type": "switch",
        "expression": [
            "not",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ]
        ],
        "variable": null,
        "value": 0,
        "mode": "walk",
        "branches": [
            "option.fanta.4.1",
            "option.fanta.4.2"
        ],
        "weights": [
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:74:3"
    },
    "option.fanta.4.1": {
        "type": "opt",
        "question": [
            "option.fanta.4.1.0.2",
            "option.fanta.4.1.0.3"
        ],
        "answer": [
            "option.fanta.4.1.0.1",
            "option.fanta.4.1.0.3",
            "option.fanta.4.1.0.4"
        ],
        "keywords": [],
        "next": "option.fanta.4.1.1",
        "position": "snackroom.kni:75:7"
    },
    "option.fanta.4.1.0.1": {
        "type": "text",
        "text": "You purchase a r",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:75:7"
    },
    "option.fanta.4.1.0.2": {
        "type": "text",
        "text": "R",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:75:7"
    },
    "option.fanta.4.1.0.3": {
        "type": "text",
        "text": "ed Fanta.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:75:7"
    },
    "option.fanta.4.1.0.4": {
        "type": "call",
        "label": "fanta.flavor",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:75:7"
    },
    "option.fanta.4.1.1": {
        "type": "opt",
        "question": [
            "option.fanta.4.1.1.2",
            "option.fanta.4.1.1.3"
        ],
        "answer": [
            "option.fanta.4.1.1.1",
            "option.fanta.4.1.1.3",
            "option.fanta.4.1.1.4"
        ],
        "keywords": [],
        "next": "option.fanta.4.1.2",
        "position": "snackroom.kni:76:7"
    },
    "option.fanta.4.1.1.1": {
        "type": "text",
        "text": "You purchase an o",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:76:7"
    },
    "option.fanta.4.1.1.2": {
        "type": "text",
        "text": "O",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:76:7"
    },
    "option.fanta.4.1.1.3": {
        "type": "text",
        "text": "range Fanta.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:76:7"
    },
    "option.fanta.4.1.1.4": {
        "type": "call",
        "label": "fanta.flavor",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:76:7"
    },
    "option.fanta.4.1.2": {
        "type": "opt",
        "question": [
            "option.fanta.4.1.2.2",
            "option.fanta.4.1.2.3"
        ],
        "answer": [
            "option.fanta.4.1.2.1",
            "option.fanta.4.1.2.3",
            "option.fanta.4.1.2.4"
        ],
        "keywords": [],
        "next": "option.fanta.4.1.3",
        "position": "snackroom.kni:77:7"
    },
    "option.fanta.4.1.2.1": {
        "type": "text",
        "text": "You purchase a b",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:77:7"
    },
    "option.fanta.4.1.2.2": {
        "type": "text",
        "text": "B",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:77:7"
    },
    "option.fanta.4.1.2.3": {
        "type": "text",
        "text": "lue Fanta.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:77:7"
    },
    "option.fanta.4.1.2.4": {
        "type": "call",
        "label": "fanta.flavor",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:77:7"
    },
    "option.fanta.4.1.3": {
        "type": "opt",
        "question": [
            "option.fanta.4.1.3.2",
            "option.fanta.4.1.3.3"
        ],
        "answer": [
            "option.fanta.4.1.3.1",
            "option.fanta.4.1.3.3",
            "option.fanta.4.1.3.4"
        ],
        "keywords": [],
        "next": "option.fanta.4.1.4",
        "position": "snackroom.kni:78:7"
    },
    "option.fanta.4.1.3.1": {
        "type": "text",
        "text": "You purchase a v",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:78:7"
    },
    "option.fanta.4.1.3.2": {
        "type": "text",
        "text": "V",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:78:7"
    },
    "option.fanta.4.1.3.3": {
        "type": "text",
        "text": "iolet Fanta.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:78:7"
    },
    "option.fanta.4.1.3.4": {
        "type": "call",
        "label": "fanta.flavor",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:78:7"
    },
    "option.fanta.4.1.4": {
        "type": "opt",
        "question": [
            "option.fanta.4.1.4.2",
            "option.fanta.4.1.4.3"
        ],
        "answer": [
            "option.fanta.4.1.4.1",
            "option.fanta.4.1.4.3",
            "option.fanta.4.1.4.4"
        ],
        "keywords": [],
        "next": "option.fanta.4.1.5",
        "position": "snackroom.kni:79:7"
    },
    "option.fanta.4.1.4.1": {
        "type": "text",
        "text": "You purchase a g",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:79:7"
    },
    "option.fanta.4.1.4.2": {
        "type": "text",
        "text": "G",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:79:7"
    },
    "option.fanta.4.1.4.3": {
        "type": "text",
        "text": "reen Fanta.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:79:7"
    },
    "option.fanta.4.1.4.4": {
        "type": "call",
        "label": "fanta.flavor",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:79:7"
    },
    "option.fanta.4.1.5": {
        "type": "opt",
        "question": [
            "option.fanta.4.1.5.2",
            "option.fanta.4.1.5.3"
        ],
        "answer": [
            "option.fanta.4.1.5.1",
            "option.fanta.4.1.5.3",
            "option.fanta.4.1.5.4"
        ],
        "keywords": [],
        "next": "RET",
        "position": "snackroom.kni:80:7"
    },
    "option.fanta.4.1.5.1": {
        "type": "text",
        "text": "You purchase a y",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:80:7"
    },
    "option.fanta.4.1.5.2": {
        "type": "text",
        "text": "Y",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:80:7"
    },
    "option.fanta.4.1.5.3": {
        "type": "text",
        "text": "ellow Fanta.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:80:7"
    },
    "option.fanta.4.1.5.4": {
        "type": "call",
        "label": "fanta.flavor",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:80:7"
    },
    "option.fanta.4.2": {
        "type": "goto",
        "next": "RET",
        "position": "snackroom.kni:81:3"
    },
    "fanta.flavor": {
        "type": "def",
        "locals": [],
        "next": "fanta.flavor.1",
        "position": "snackroom.kni:83:5"
    },
    "fanta.flavor.1": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "fanta.flavor.2",
        "position": "snackroom.kni:84:5"
    },
    "fanta.flavor.2": {
        "type": "text",
        "text": "It tastes like",
        "lift": " ",
        "drop": " ",
        "next": "fanta.flavor.3",
        "position": "snackroom.kni:85:5"
    },
    "fanta.flavor.3": {
        "type": "call",
        "label": "color",
        "args": [],
        "next": "fanta.flavor.4",
        "branch": "ESC",
        "position": "snackroom.kni:85:5"
    },
    "fanta.flavor.4": {
        "type": "text",
        "text": ".",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:86:5"
    },
    "option.bento": {
        "type": "def",
        "locals": [
            "currency"
        ],
        "next": "option.bento.1",
        "position": "snackroom.kni:87:3"
    },
    "option.bento.1": {
        "type": "move",
        "source": [
            "~",
            [
                "val",
                10000
            ]
        ],
        "target": [
            "get",
            "bento.seed"
        ],
        "next": "option.bento.2",
        "position": "snackroom.kni:89:3"
    },
    "option.bento.2": {
        "type": "text",
        "text": "bento boxes.",
        "lift": "",
        "drop": " ",
        "next": "option.bento.3",
        "position": "snackroom.kni:89:3"
    },
    "option.bento.3": {
        "type": "par",
        "next": "option.bento.4",
        "position": "snackroom.kni:89:3"
    },
    "option.bento.4": {
        "type": "call",
        "label": "show.money",
        "args": [
            [
                "get",
                "currency"
            ]
        ],
        "next": "option.bento.5",
        "branch": "ESC",
        "position": "snackroom.kni:90:3"
    },
    "option.bento.5": {
        "type": "switch",
        "expression": [
            "not",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ]
        ],
        "variable": null,
        "value": 0,
        "mode": "walk",
        "branches": [
            "option.bento.5.1",
            "option.bento.5.2"
        ],
        "weights": [
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:91:3"
    },
    "option.bento.5.1": {
        "type": "opt",
        "question": [
            "option.bento.5.1.0.2",
            "option.bento.5.1.0.3"
        ],
        "answer": [
            "option.bento.5.1.0.1",
            "option.bento.5.1.0.3",
            "option.bento.5.1.0.8"
        ],
        "keywords": [],
        "next": "option.bento.5.1.1",
        "position": "snackroom.kni:92:7"
    },
    "option.bento.5.1.0.1": {
        "type": "text",
        "text": "You pick the b",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:92:7"
    },
    "option.bento.5.1.0.2": {
        "type": "text",
        "text": "B",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:92:7"
    },
    "option.bento.5.1.0.3": {
        "type": "text",
        "text": "ento with",
        "lift": "",
        "drop": " ",
        "next": "option.bento.5.1.0.4",
        "position": "snackroom.kni:92:7"
    },
    "option.bento.5.1.0.4": {
        "type": "call",
        "label": "ulam",
        "args": [
            [
                "+",
                [
                    "get",
                    "bento.seed"
                ],
                [
                    "val",
                    1
                ]
            ]
        ],
        "next": "option.bento.5.1.0.5",
        "branch": "ESC",
        "position": "snackroom.kni:92:7"
    },
    "option.bento.5.1.0.5": {
        "type": "text",
        "text": "and",
        "lift": " ",
        "drop": " ",
        "next": "option.bento.5.1.0.6",
        "position": "snackroom.kni:92:7"
    },
    "option.bento.5.1.0.6": {
        "type": "call",
        "label": "ulam",
        "args": [
            [
                "+",
                [
                    "get",
                    "bento.seed"
                ],
                [
                    "val",
                    2
                ]
            ]
        ],
        "next": "option.bento.5.1.0.7",
        "branch": "ESC",
        "position": "snackroom.kni:92:7"
    },
    "option.bento.5.1.0.7": {
        "type": "text",
        "text": ".",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:92:7"
    },
    "option.bento.5.1.0.8": {
        "type": "call",
        "label": "flavor",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:92:7"
    },
    "option.bento.5.1.1": {
        "type": "opt",
        "question": [
            "option.bento.5.1.1.2",
            "option.bento.5.1.1.3"
        ],
        "answer": [
            "option.bento.5.1.1.1",
            "option.bento.5.1.1.3",
            "option.bento.5.1.1.8"
        ],
        "keywords": [],
        "next": "option.bento.5.1.2",
        "position": "snackroom.kni:93:7"
    },
    "option.bento.5.1.1.1": {
        "type": "text",
        "text": "You pick the b",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:93:7"
    },
    "option.bento.5.1.1.2": {
        "type": "text",
        "text": "B",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:93:7"
    },
    "option.bento.5.1.1.3": {
        "type": "text",
        "text": "ento with",
        "lift": "",
        "drop": " ",
        "next": "option.bento.5.1.1.4",
        "position": "snackroom.kni:93:7"
    },
    "option.bento.5.1.1.4": {
        "type": "call",
        "label": "ulam",
        "args": [
            [
                "+",
                [
                    "get",
                    "bento.seed"
                ],
                [
                    "val",
                    3
                ]
            ]
        ],
        "next": "option.bento.5.1.1.5",
        "branch": "ESC",
        "position": "snackroom.kni:93:7"
    },
    "option.bento.5.1.1.5": {
        "type": "text",
        "text": "and",
        "lift": " ",
        "drop": " ",
        "next": "option.bento.5.1.1.6",
        "position": "snackroom.kni:93:7"
    },
    "option.bento.5.1.1.6": {
        "type": "call",
        "label": "ulam",
        "args": [
            [
                "+",
                [
                    "get",
                    "bento.seed"
                ],
                [
                    "val",
                    4
                ]
            ]
        ],
        "next": "option.bento.5.1.1.7",
        "branch": "ESC",
        "position": "snackroom.kni:93:7"
    },
    "option.bento.5.1.1.7": {
        "type": "text",
        "text": ".",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:93:7"
    },
    "option.bento.5.1.1.8": {
        "type": "call",
        "label": "flavor",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:93:7"
    },
    "option.bento.5.1.2": {
        "type": "opt",
        "question": [
            "option.bento.5.1.2.2",
            "option.bento.5.1.2.3"
        ],
        "answer": [
            "option.bento.5.1.2.1",
            "option.bento.5.1.2.3",
            "option.bento.5.1.2.8"
        ],
        "keywords": [],
        "next": "RET",
        "position": "snackroom.kni:94:7"
    },
    "option.bento.5.1.2.1": {
        "type": "text",
        "text": "You pick the b",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:94:7"
    },
    "option.bento.5.1.2.2": {
        "type": "text",
        "text": "B",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:94:7"
    },
    "option.bento.5.1.2.3": {
        "type": "text",
        "text": "ento with",
        "lift": "",
        "drop": " ",
        "next": "option.bento.5.1.2.4",
        "position": "snackroom.kni:94:7"
    },
    "option.bento.5.1.2.4": {
        "type": "call",
        "label": "ulam",
        "args": [
            [
                "+",
                [
                    "get",
                    "bento.seed"
                ],
                [
                    "val",
                    5
                ]
            ]
        ],
        "next": "option.bento.5.1.2.5",
        "branch": "ESC",
        "position": "snackroom.kni:94:7"
    },
    "option.bento.5.1.2.5": {
        "type": "text",
        "text": "and",
        "lift": " ",
        "drop": " ",
        "next": "option.bento.5.1.2.6",
        "position": "snackroom.kni:94:7"
    },
    "option.bento.5.1.2.6": {
        "type": "call",
        "label": "ulam",
        "args": [
            [
                "+",
                [
                    "get",
                    "bento.seed"
                ],
                [
                    "val",
                    6
                ]
            ]
        ],
        "next": "option.bento.5.1.2.7",
        "branch": "ESC",
        "position": "snackroom.kni:94:7"
    },
    "option.bento.5.1.2.7": {
        "type": "text",
        "text": ".",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:94:7"
    },
    "option.bento.5.1.2.8": {
        "type": "call",
        "label": "flavor",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:94:7"
    },
    "option.bento.5.2": {
        "type": "goto",
        "next": "RET",
        "position": "snackroom.kni:95:3"
    },
    "ulam": {
        "type": "def",
        "locals": [
            "n"
        ],
        "next": "ulam.1",
        "position": "snackroom.kni:97:5"
    },
    "ulam.1": {
        "type": "switch",
        "expression": [
            "get",
            "n"
        ],
        "variable": null,
        "value": 0,
        "mode": "hash",
        "branches": [
            "ulam.1.1",
            "ulam.1.2",
            "ulam.1.3",
            "ulam.1.4",
            "ulam.1.5",
            "ulam.1.6",
            "ulam.1.7",
            "ulam.1.8",
            "ulam.1.9",
            "ulam.1.10",
            "ulam.1.11",
            "ulam.1.12",
            "ulam.1.13",
            "ulam.1.14",
            "ulam.1.15",
            "ulam.1.16",
            "ulam.1.17",
            "ulam.1.18",
            "ulam.1.19",
            "ulam.1.20",
            "ulam.1.21",
            "ulam.1.22",
            "ulam.1.23"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.1": {
        "type": "text",
        "text": "shrimp tempura",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.2": {
        "type": "text",
        "text": "vegetable tempura",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.3": {
        "type": "text",
        "text": "beef teriyaki",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.4": {
        "type": "text",
        "text": "chicken teriyaki",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.5": {
        "type": "text",
        "text": "salmon teriyaki",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.6": {
        "type": "text",
        "text": "chicken katsu",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.7": {
        "type": "text",
        "text": "pork katsu",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.8": {
        "type": "text",
        "text": "california rolls",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.9": {
        "type": "text",
        "text": "salad",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.10": {
        "type": "text",
        "text": "takoyaki",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.11": {
        "type": "text",
        "text": "grilled mackerel",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.12": {
        "type": "text",
        "text": "grilled salmon",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.13": {
        "type": "text",
        "text": "tamago",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.14": {
        "type": "text",
        "text": "gorditas",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.15": {
        "type": "text",
        "text": "pickles",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.16": {
        "type": "text",
        "text": "sashimi",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.17": {
        "type": "text",
        "text": "seared tuna",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.18": {
        "type": "text",
        "text": "miso salmon",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.19": {
        "type": "text",
        "text": "natto",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.20": {
        "type": "text",
        "text": "hijiki",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.21": {
        "type": "text",
        "text": "gyoza",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.22": {
        "type": "text",
        "text": "croquettes",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "ulam.1.23": {
        "type": "text",
        "text": "noodles",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:98:5"
    },
    "flavor": {
        "type": "def",
        "locals": [],
        "next": "flavor.1",
        "position": "snackroom.kni:100:5"
    },
    "flavor.1": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "flavor.2",
        "position": "snackroom.kni:101:5"
    },
    "flavor.2": {
        "type": "text",
        "text": "It's",
        "lift": " ",
        "drop": " ",
        "next": "flavor.3",
        "position": "snackroom.kni:102:5"
    },
    "flavor.3": {
        "type": "switch",
        "expression": [
            "get",
            "flavor.3"
        ],
        "variable": "flavor.3",
        "value": 0,
        "mode": "rand",
        "branches": [
            "flavor.3.1",
            "flavor.3.2",
            "flavor.3.3",
            "flavor.3.4"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:102:5"
    },
    "flavor.3.1": {
        "type": "text",
        "text": "light",
        "lift": "",
        "drop": "",
        "next": "flavor.4",
        "position": "snackroom.kni:102:5"
    },
    "flavor.3.2": {
        "type": "text",
        "text": "heavy",
        "lift": "",
        "drop": "",
        "next": "flavor.4",
        "position": "snackroom.kni:102:5"
    },
    "flavor.3.3": {
        "type": "text",
        "text": "hearty",
        "lift": "",
        "drop": "",
        "next": "flavor.4",
        "position": "snackroom.kni:102:5"
    },
    "flavor.3.4": {
        "type": "text",
        "text": "filling",
        "lift": "",
        "drop": "",
        "next": "flavor.4",
        "position": "snackroom.kni:102:5"
    },
    "flavor.4": {
        "type": "text",
        "text": "and delicious.",
        "lift": " ",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:103:5"
    },
    "option.tea": {
        "type": "def",
        "locals": [
            "currency"
        ],
        "next": "option.tea.1",
        "position": "snackroom.kni:104:3"
    },
    "option.tea.1": {
        "type": "text",
        "text": "tea.",
        "lift": " ",
        "drop": " ",
        "next": "option.tea.2",
        "position": "snackroom.kni:105:3"
    },
    "option.tea.2": {
        "type": "par",
        "next": "option.tea.3",
        "position": "snackroom.kni:105:3"
    },
    "option.tea.3": {
        "type": "call",
        "label": "show.money",
        "args": [
            [
                "get",
                "currency"
            ]
        ],
        "next": "option.tea.4",
        "branch": "ESC",
        "position": "snackroom.kni:106:3"
    },
    "option.tea.4": {
        "type": "switch",
        "expression": [
            "not",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ]
        ],
        "variable": null,
        "value": 0,
        "mode": "walk",
        "branches": [
            "option.tea.4.1",
            "option.tea.4.2"
        ],
        "weights": [
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:107:3"
    },
    "option.tea.4.1": {
        "type": "opt",
        "question": [
            "option.tea.4.1.0.2",
            "option.tea.4.1.0.3"
        ],
        "answer": [
            "option.tea.4.1.0.1",
            "option.tea.4.1.0.3",
            "option.tea.4.1.0.4"
        ],
        "keywords": [],
        "next": "option.tea.4.1.1",
        "position": "snackroom.kni:108:7"
    },
    "option.tea.4.1.0.1": {
        "type": "text",
        "text": "You purchase a cup of c",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:108:7"
    },
    "option.tea.4.1.0.2": {
        "type": "text",
        "text": "C",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:108:7"
    },
    "option.tea.4.1.0.3": {
        "type": "text",
        "text": "hamomile.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:108:7"
    },
    "option.tea.4.1.0.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.tea.4.1.0.5",
        "position": "snackroom.kni:108:7"
    },
    "option.tea.4.1.0.5": {
        "type": "text",
        "text": "You feel calm.",
        "lift": " ",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:109:7"
    },
    "option.tea.4.1.1": {
        "type": "opt",
        "question": [
            "option.tea.4.1.1.2",
            "option.tea.4.1.1.3"
        ],
        "answer": [
            "option.tea.4.1.1.1",
            "option.tea.4.1.1.3",
            "option.tea.4.1.1.4"
        ],
        "keywords": [],
        "next": "option.tea.4.1.2",
        "position": "snackroom.kni:109:7"
    },
    "option.tea.4.1.1.1": {
        "type": "text",
        "text": "You purchase a cup of e",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:109:7"
    },
    "option.tea.4.1.1.2": {
        "type": "text",
        "text": "E",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:109:7"
    },
    "option.tea.4.1.1.3": {
        "type": "text",
        "text": "arl grey.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:109:7"
    },
    "option.tea.4.1.1.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.tea.4.1.1.5",
        "position": "snackroom.kni:109:7"
    },
    "option.tea.4.1.1.5": {
        "type": "text",
        "text": "You feel awake.",
        "lift": " ",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:110:7"
    },
    "option.tea.4.1.2": {
        "type": "opt",
        "question": [
            "option.tea.4.1.2.2",
            "option.tea.4.1.2.3"
        ],
        "answer": [
            "option.tea.4.1.2.1",
            "option.tea.4.1.2.3",
            "option.tea.4.1.2.4"
        ],
        "keywords": [],
        "next": "option.tea.4.1.3",
        "position": "snackroom.kni:110:7"
    },
    "option.tea.4.1.2.1": {
        "type": "text",
        "text": "You purchase a cup of g",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:110:7"
    },
    "option.tea.4.1.2.2": {
        "type": "text",
        "text": "G",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:110:7"
    },
    "option.tea.4.1.2.3": {
        "type": "text",
        "text": "reen tea.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:110:7"
    },
    "option.tea.4.1.2.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.tea.4.1.2.5",
        "position": "snackroom.kni:110:7"
    },
    "option.tea.4.1.2.5": {
        "type": "text",
        "text": "You feel focused.",
        "lift": " ",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:111:7"
    },
    "option.tea.4.1.3": {
        "type": "opt",
        "question": [
            "option.tea.4.1.3.2",
            "option.tea.4.1.3.3"
        ],
        "answer": [
            "option.tea.4.1.3.1",
            "option.tea.4.1.3.3",
            "option.tea.4.1.3.4"
        ],
        "keywords": [],
        "next": "option.tea.4.1.4",
        "position": "snackroom.kni:111:7"
    },
    "option.tea.4.1.3.1": {
        "type": "text",
        "text": "You purchase a cup of o",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:111:7"
    },
    "option.tea.4.1.3.2": {
        "type": "text",
        "text": "O",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:111:7"
    },
    "option.tea.4.1.3.3": {
        "type": "text",
        "text": "olong.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:111:7"
    },
    "option.tea.4.1.3.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.tea.4.1.3.5",
        "position": "snackroom.kni:111:7"
    },
    "option.tea.4.1.3.5": {
        "type": "text",
        "text": "You feel alert.",
        "lift": " ",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:112:7"
    },
    "option.tea.4.1.4": {
        "type": "opt",
        "question": [
            "option.tea.4.1.4.2",
            "option.tea.4.1.4.3"
        ],
        "answer": [
            "option.tea.4.1.4.1",
            "option.tea.4.1.4.3",
            "option.tea.4.1.4.4"
        ],
        "keywords": [],
        "next": "option.tea.4.1.5",
        "position": "snackroom.kni:112:7"
    },
    "option.tea.4.1.4.1": {
        "type": "text",
        "text": "You purchase a cup of r",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:112:7"
    },
    "option.tea.4.1.4.2": {
        "type": "text",
        "text": "R",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:112:7"
    },
    "option.tea.4.1.4.3": {
        "type": "text",
        "text": "ooibos.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:112:7"
    },
    "option.tea.4.1.4.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.tea.4.1.4.5",
        "position": "snackroom.kni:112:7"
    },
    "option.tea.4.1.4.5": {
        "type": "text",
        "text": "You feel peaceful.",
        "lift": " ",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:113:7"
    },
    "option.tea.4.1.5": {
        "type": "opt",
        "question": [
            "option.tea.4.1.5.2",
            "option.tea.4.1.5.3"
        ],
        "answer": [
            "option.tea.4.1.5.1",
            "option.tea.4.1.5.3",
            "option.tea.4.1.5.4"
        ],
        "keywords": [],
        "next": "option.tea.4.1.6",
        "position": "snackroom.kni:113:7"
    },
    "option.tea.4.1.5.1": {
        "type": "text",
        "text": "You purchase a cup of m",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:113:7"
    },
    "option.tea.4.1.5.2": {
        "type": "text",
        "text": "M",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:113:7"
    },
    "option.tea.4.1.5.3": {
        "type": "text",
        "text": "atcha.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:113:7"
    },
    "option.tea.4.1.5.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.tea.4.1.5.5",
        "position": "snackroom.kni:113:7"
    },
    "option.tea.4.1.5.5": {
        "type": "text",
        "text": "You feel jazzed.",
        "lift": " ",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:114:7"
    },
    "option.tea.4.1.6": {
        "type": "opt",
        "question": [
            "option.tea.4.1.6.2",
            "option.tea.4.1.6.3"
        ],
        "answer": [
            "option.tea.4.1.6.1",
            "option.tea.4.1.6.3",
            "option.tea.4.1.6.4"
        ],
        "keywords": [],
        "next": "option.tea.4.1.7",
        "position": "snackroom.kni:114:7"
    },
    "option.tea.4.1.6.1": {
        "type": "text",
        "text": "You purchase a cup of g",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:114:7"
    },
    "option.tea.4.1.6.2": {
        "type": "text",
        "text": "G",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:114:7"
    },
    "option.tea.4.1.6.3": {
        "type": "text",
        "text": "inger.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:114:7"
    },
    "option.tea.4.1.6.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.tea.4.1.6.5",
        "position": "snackroom.kni:114:7"
    },
    "option.tea.4.1.6.5": {
        "type": "text",
        "text": "Your tummy feels great.",
        "lift": " ",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:115:7"
    },
    "option.tea.4.1.7": {
        "type": "opt",
        "question": [
            "option.tea.4.1.7.2",
            "option.tea.4.1.7.3"
        ],
        "answer": [
            "option.tea.4.1.7.1",
            "option.tea.4.1.7.3",
            "option.tea.4.1.7.4"
        ],
        "keywords": [],
        "next": "RET",
        "position": "snackroom.kni:115:7"
    },
    "option.tea.4.1.7.1": {
        "type": "text",
        "text": "You purchase a cup of p",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:115:7"
    },
    "option.tea.4.1.7.2": {
        "type": "text",
        "text": "P",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:115:7"
    },
    "option.tea.4.1.7.3": {
        "type": "text",
        "text": "u-erh.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:115:7"
    },
    "option.tea.4.1.7.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.tea.4.1.7.5",
        "position": "snackroom.kni:115:7"
    },
    "option.tea.4.1.7.5": {
        "type": "text",
        "text": "You feel sharp.",
        "lift": " ",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:116:3"
    },
    "option.tea.4.2": {
        "type": "goto",
        "next": "RET",
        "position": "snackroom.kni:116:3"
    },
    "option.pizza": {
        "type": "def",
        "locals": [
            "currency"
        ],
        "next": "option.pizza.1",
        "position": "snackroom.kni:118:3"
    },
    "option.pizza.1": {
        "type": "move",
        "source": [
            "~",
            [
                "val",
                999
            ]
        ],
        "target": [
            "get",
            "seed.sauce"
        ],
        "next": "option.pizza.2",
        "position": "snackroom.kni:120:5"
    },
    "option.pizza.2": {
        "type": "move",
        "source": [
            "~",
            [
                "val",
                999
            ]
        ],
        "target": [
            "get",
            "seed.style"
        ],
        "next": "option.pizza.3",
        "position": "snackroom.kni:121:5"
    },
    "option.pizza.3": {
        "type": "move",
        "source": [
            "~",
            [
                "val",
                10000
            ]
        ],
        "target": [
            "get",
            "seed.topping"
        ],
        "next": "option.pizza.4",
        "position": "snackroom.kni:122:3"
    },
    "option.pizza.4": {
        "type": "text",
        "text": "pizza.",
        "lift": "",
        "drop": " ",
        "next": "option.pizza.5",
        "position": "snackroom.kni:122:3"
    },
    "option.pizza.5": {
        "type": "par",
        "next": "option.pizza.6",
        "position": "snackroom.kni:122:3"
    },
    "option.pizza.6": {
        "type": "call",
        "label": "show.money",
        "args": [
            [
                "get",
                "currency"
            ]
        ],
        "next": "option.pizza.7",
        "branch": "ESC",
        "position": "snackroom.kni:123:3"
    },
    "option.pizza.7": {
        "type": "switch",
        "expression": [
            "not",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ]
        ],
        "variable": null,
        "value": 0,
        "mode": "walk",
        "branches": [
            "option.pizza.7.1",
            "option.pizza.7.2"
        ],
        "weights": [
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:124:3"
    },
    "option.pizza.7.1": {
        "type": "opt",
        "question": [
            "option.pizza.7.1.0.2"
        ],
        "answer": [
            "option.pizza.7.1.0.1",
            "option.pizza.7.1.0.2",
            "option.pizza.7.1.0.3"
        ],
        "keywords": [],
        "next": "option.pizza.7.1.1",
        "position": "snackroom.kni:125:7"
    },
    "option.pizza.7.1.0.1": {
        "type": "text",
        "text": "You order a personal",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:125:7"
    },
    "option.pizza.7.1.0.2": {
        "type": "call",
        "label": "make.pizza",
        "args": [
            [
                "get",
                "seed.sauce"
            ],
            [
                "get",
                "seed.style"
            ],
            [
                "get",
                "seed.topping"
            ]
        ],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:125:7"
    },
    "option.pizza.7.1.0.3": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.pizza.7.1.0.4",
        "position": "snackroom.kni:125:7"
    },
    "option.pizza.7.1.0.4": {
        "type": "call",
        "label": "eat",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:125:7"
    },
    "option.pizza.7.1.1": {
        "type": "opt",
        "question": [
            "option.pizza.7.1.1.2"
        ],
        "answer": [
            "option.pizza.7.1.1.1",
            "option.pizza.7.1.1.2",
            "option.pizza.7.1.1.3"
        ],
        "keywords": [],
        "next": "option.pizza.7.1.2",
        "position": "snackroom.kni:126:7"
    },
    "option.pizza.7.1.1.1": {
        "type": "text",
        "text": "You order a personal",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:126:7"
    },
    "option.pizza.7.1.1.2": {
        "type": "call",
        "label": "make.pizza",
        "args": [
            [
                "+",
                [
                    "get",
                    "seed.sauce"
                ],
                [
                    "val",
                    1
                ]
            ],
            [
                "+",
                [
                    "get",
                    "seed.style"
                ],
                [
                    "val",
                    1
                ]
            ],
            [
                "+",
                [
                    "get",
                    "seed.topping"
                ],
                [
                    "val",
                    1
                ]
            ]
        ],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:126:7"
    },
    "option.pizza.7.1.1.3": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.pizza.7.1.1.4",
        "position": "snackroom.kni:126:7"
    },
    "option.pizza.7.1.1.4": {
        "type": "call",
        "label": "eat",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:126:7"
    },
    "option.pizza.7.1.2": {
        "type": "opt",
        "question": [
            "option.pizza.7.1.2.2"
        ],
        "answer": [
            "option.pizza.7.1.2.1",
            "option.pizza.7.1.2.2",
            "option.pizza.7.1.2.3"
        ],
        "keywords": [],
        "next": "RET",
        "position": "snackroom.kni:127:7"
    },
    "option.pizza.7.1.2.1": {
        "type": "text",
        "text": "You order a personal",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:127:7"
    },
    "option.pizza.7.1.2.2": {
        "type": "call",
        "label": "make.pizza",
        "args": [
            [
                "+",
                [
                    "get",
                    "seed.sauce"
                ],
                [
                    "val",
                    2
                ]
            ],
            [
                "+",
                [
                    "get",
                    "seed.style"
                ],
                [
                    "val",
                    2
                ]
            ],
            [
                "+",
                [
                    "get",
                    "seed.topping"
                ],
                [
                    "val",
                    2
                ]
            ]
        ],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:127:7"
    },
    "option.pizza.7.1.2.3": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.pizza.7.1.2.4",
        "position": "snackroom.kni:127:7"
    },
    "option.pizza.7.1.2.4": {
        "type": "call",
        "label": "eat",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:127:7"
    },
    "option.pizza.7.2": {
        "type": "goto",
        "next": "RET",
        "position": "snackroom.kni:128:3"
    },
    "make.pizza": {
        "type": "def",
        "locals": [
            "sc",
            "st",
            "tp"
        ],
        "next": "make.pizza.1",
        "position": "snackroom.kni:130:5"
    },
    "make.pizza.1": {
        "type": "switch",
        "expression": [
            "get",
            "sc"
        ],
        "variable": null,
        "value": 0,
        "mode": "hash",
        "branches": [
            "make.pizza.1.1",
            "make.pizza.1.2",
            "make.pizza.1.3",
            "make.pizza.1.4"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:131:5"
    },
    "make.pizza.1.1": {
        "type": "text",
        "text": "Detroit",
        "lift": "",
        "drop": "",
        "next": "make.pizza.2",
        "position": "snackroom.kni:131:5"
    },
    "make.pizza.1.2": {
        "type": "text",
        "text": "Chicago",
        "lift": "",
        "drop": "",
        "next": "make.pizza.2",
        "position": "snackroom.kni:131:5"
    },
    "make.pizza.1.3": {
        "type": "text",
        "text": "New York",
        "lift": "",
        "drop": "",
        "next": "make.pizza.2",
        "position": "snackroom.kni:131:5"
    },
    "make.pizza.1.4": {
        "type": "text",
        "text": "Neopolitan",
        "lift": "",
        "drop": "",
        "next": "make.pizza.2",
        "position": "snackroom.kni:131:5"
    },
    "make.pizza.2": {
        "type": "text",
        "text": "style pizza with",
        "lift": " ",
        "drop": " ",
        "next": "make.pizza.3",
        "position": "snackroom.kni:131:5"
    },
    "make.pizza.3": {
        "type": "switch",
        "expression": [
            "get",
            "st"
        ],
        "variable": null,
        "value": 0,
        "mode": "hash",
        "branches": [
            "make.pizza.3.1",
            "make.pizza.3.2",
            "make.pizza.3.3"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:131:5"
    },
    "make.pizza.3.1": {
        "type": "text",
        "text": "red sauce",
        "lift": "",
        "drop": "",
        "next": "make.pizza.4",
        "position": "snackroom.kni:131:5"
    },
    "make.pizza.3.2": {
        "type": "text",
        "text": "white sauce",
        "lift": "",
        "drop": "",
        "next": "make.pizza.4",
        "position": "snackroom.kni:131:5"
    },
    "make.pizza.3.3": {
        "type": "text",
        "text": "pesto",
        "lift": "",
        "drop": "",
        "next": "make.pizza.4",
        "position": "snackroom.kni:131:5"
    },
    "make.pizza.4": {
        "type": "call",
        "label": "topping",
        "args": [
            [
                "get",
                "tp"
            ]
        ],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:131:5"
    },
    "topping": {
        "type": "def",
        "locals": [
            "p"
        ],
        "next": "topping.1",
        "position": "snackroom.kni:133:5"
    },
    "topping.1": {
        "type": "switch",
        "expression": [
            "get",
            "p"
        ],
        "variable": null,
        "value": 0,
        "mode": "hash",
        "branches": [
            "topping.1.1",
            "topping.1.2",
            "topping.1.3",
            "topping.1.4",
            "topping.1.5",
            "topping.1.6",
            "topping.1.7",
            "topping.1.8",
            "topping.1.9",
            "topping.1.10",
            "topping.1.11",
            "topping.1.12",
            "topping.1.13",
            "topping.1.14",
            "topping.1.15",
            "topping.1.16"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:135:5"
    },
    "topping.1.1": {
        "type": "text",
        "text": ".",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:136:5"
    },
    "topping.1.2": {
        "type": "text",
        "text": ", topped with pepperoni.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:137:5"
    },
    "topping.1.3": {
        "type": "text",
        "text": ", topped with anchovies.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:138:5"
    },
    "topping.1.4": {
        "type": "text",
        "text": ", topped with mushrooms.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:139:5"
    },
    "topping.1.5": {
        "type": "text",
        "text": ", topped with olives.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:140:5"
    },
    "topping.1.6": {
        "type": "text",
        "text": ", topped with garlic.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:141:5"
    },
    "topping.1.7": {
        "type": "text",
        "text": ", topped with onions.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:142:5"
    },
    "topping.1.8": {
        "type": "text",
        "text": ", topped with bbq chicken.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:143:5"
    },
    "topping.1.9": {
        "type": "text",
        "text": ", topped with extra cheese.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:144:5"
    },
    "topping.1.10": {
        "type": "text",
        "text": ", topped with sausage.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:145:5"
    },
    "topping.1.11": {
        "type": "text",
        "text": ", topped with fresh basil.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:146:5"
    },
    "topping.1.12": {
        "type": "text",
        "text": ", topped with something red.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:147:5"
    },
    "topping.1.13": {
        "type": "text",
        "text": ", topped with lies.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:148:5"
    },
    "topping.1.14": {
        "type": "text",
        "text": ", topped with eggs.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:149:5"
    },
    "topping.1.15": {
        "type": "text",
        "text": ", topped with pineapple.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:150:5"
    },
    "topping.1.16": {
        "type": "text",
        "text": ", topped with beans.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:151:5"
    },
    "eat": {
        "type": "def",
        "locals": [],
        "next": "eat.1",
        "position": "snackroom.kni:191:5"
    },
    "eat.1": {
        "type": "switch",
        "expression": [
            "get",
            "eat.1"
        ],
        "variable": "eat.1",
        "value": 0,
        "mode": "rand",
        "branches": [
            "eat.1.1",
            "eat.1.2",
            "eat.1.3",
            "eat.1.4",
            "eat.1.5",
            "eat.1.6"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:193:5"
    },
    "eat.1.1": {
        "type": "text",
        "text": "Cronch.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:194:5"
    },
    "eat.1.2": {
        "type": "text",
        "text": "You feel healthy.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:195:5"
    },
    "eat.1.3": {
        "type": "text",
        "text": "You feel great.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:196:5"
    },
    "eat.1.4": {
        "type": "text",
        "text": "You feel like a bird.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:197:5"
    },
    "eat.1.5": {
        "type": "text",
        "text": "Cromch.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:198:5"
    },
    "option.dippindots": {
        "type": "def",
        "locals": [
            "currency"
        ],
        "next": "option.dippindots.1",
        "position": "snackroom.kni:163:3"
    },
    "option.dippindots.1": {
        "type": "text",
        "text": "dippin' dots.",
        "lift": " ",
        "drop": " ",
        "next": "option.dippindots.2",
        "position": "snackroom.kni:164:3"
    },
    "option.dippindots.2": {
        "type": "par",
        "next": "option.dippindots.3",
        "position": "snackroom.kni:164:3"
    },
    "option.dippindots.3": {
        "type": "call",
        "label": "show.money",
        "args": [
            [
                "get",
                "currency"
            ]
        ],
        "next": "option.dippindots.4",
        "branch": "ESC",
        "position": "snackroom.kni:165:3"
    },
    "option.dippindots.4": {
        "type": "switch",
        "expression": [
            "not",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ]
        ],
        "variable": null,
        "value": 0,
        "mode": "walk",
        "branches": [
            "option.dippindots.4.1",
            "option.dippindots.4.2"
        ],
        "weights": [
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:166:3"
    },
    "option.dippindots.4.1": {
        "type": "opt",
        "question": [
            "option.dippindots.4.1.0.2",
            "option.dippindots.4.1.0.3"
        ],
        "answer": [
            "option.dippindots.4.1.0.1",
            "option.dippindots.4.1.0.3",
            "option.dippindots.4.1.0.4"
        ],
        "keywords": [],
        "next": "option.dippindots.4.1.1",
        "position": "snackroom.kni:167:7"
    },
    "option.dippindots.4.1.0.1": {
        "type": "text",
        "text": "You get c",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:167:7"
    },
    "option.dippindots.4.1.0.2": {
        "type": "text",
        "text": "C",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:167:7"
    },
    "option.dippindots.4.1.0.3": {
        "type": "text",
        "text": "ookies n cream.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:167:7"
    },
    "option.dippindots.4.1.0.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.dippindots.4.1.0.5",
        "position": "snackroom.kni:167:7"
    },
    "option.dippindots.4.1.0.5": {
        "type": "call",
        "label": "taste",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:167:7"
    },
    "option.dippindots.4.1.1": {
        "type": "opt",
        "question": [
            "option.dippindots.4.1.1.2",
            "option.dippindots.4.1.1.3"
        ],
        "answer": [
            "option.dippindots.4.1.1.1",
            "option.dippindots.4.1.1.3",
            "option.dippindots.4.1.1.4"
        ],
        "keywords": [],
        "next": "option.dippindots.4.1.2",
        "position": "snackroom.kni:168:7"
    },
    "option.dippindots.4.1.1.1": {
        "type": "text",
        "text": "You get b",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:168:7"
    },
    "option.dippindots.4.1.1.2": {
        "type": "text",
        "text": "B",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:168:7"
    },
    "option.dippindots.4.1.1.3": {
        "type": "text",
        "text": "anana split.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:168:7"
    },
    "option.dippindots.4.1.1.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.dippindots.4.1.1.5",
        "position": "snackroom.kni:168:7"
    },
    "option.dippindots.4.1.1.5": {
        "type": "call",
        "label": "taste",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:168:7"
    },
    "option.dippindots.4.1.2": {
        "type": "opt",
        "question": [
            "option.dippindots.4.1.2.2",
            "option.dippindots.4.1.2.3"
        ],
        "answer": [
            "option.dippindots.4.1.2.1",
            "option.dippindots.4.1.2.3",
            "option.dippindots.4.1.2.4"
        ],
        "keywords": [],
        "next": "option.dippindots.4.1.3",
        "position": "snackroom.kni:169:7"
    },
    "option.dippindots.4.1.2.1": {
        "type": "text",
        "text": "You get b",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:169:7"
    },
    "option.dippindots.4.1.2.2": {
        "type": "text",
        "text": "B",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:169:7"
    },
    "option.dippindots.4.1.2.3": {
        "type": "text",
        "text": "irthday cake.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:169:7"
    },
    "option.dippindots.4.1.2.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.dippindots.4.1.2.5",
        "position": "snackroom.kni:169:7"
    },
    "option.dippindots.4.1.2.5": {
        "type": "call",
        "label": "taste",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:169:7"
    },
    "option.dippindots.4.1.3": {
        "type": "opt",
        "question": [
            "option.dippindots.4.1.3.2",
            "option.dippindots.4.1.3.3"
        ],
        "answer": [
            "option.dippindots.4.1.3.1",
            "option.dippindots.4.1.3.3",
            "option.dippindots.4.1.3.4"
        ],
        "keywords": [],
        "next": "option.dippindots.4.1.4",
        "position": "snackroom.kni:170:7"
    },
    "option.dippindots.4.1.3.1": {
        "type": "text",
        "text": "You get b",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:170:7"
    },
    "option.dippindots.4.1.3.2": {
        "type": "text",
        "text": "B",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:170:7"
    },
    "option.dippindots.4.1.3.3": {
        "type": "text",
        "text": "ubble gum.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:170:7"
    },
    "option.dippindots.4.1.3.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.dippindots.4.1.3.5",
        "position": "snackroom.kni:170:7"
    },
    "option.dippindots.4.1.3.5": {
        "type": "call",
        "label": "taste",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:170:7"
    },
    "option.dippindots.4.1.4": {
        "type": "opt",
        "question": [
            "option.dippindots.4.1.4.2",
            "option.dippindots.4.1.4.3"
        ],
        "answer": [
            "option.dippindots.4.1.4.1",
            "option.dippindots.4.1.4.3",
            "option.dippindots.4.1.4.4"
        ],
        "keywords": [],
        "next": "option.dippindots.4.1.5",
        "position": "snackroom.kni:171:7"
    },
    "option.dippindots.4.1.4.1": {
        "type": "text",
        "text": "You get c",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:171:7"
    },
    "option.dippindots.4.1.4.2": {
        "type": "text",
        "text": "C",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:171:7"
    },
    "option.dippindots.4.1.4.3": {
        "type": "text",
        "text": "hocolate.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:171:7"
    },
    "option.dippindots.4.1.4.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.dippindots.4.1.4.5",
        "position": "snackroom.kni:171:7"
    },
    "option.dippindots.4.1.4.5": {
        "type": "call",
        "label": "taste",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:171:7"
    },
    "option.dippindots.4.1.5": {
        "type": "opt",
        "question": [
            "option.dippindots.4.1.5.2",
            "option.dippindots.4.1.5.3"
        ],
        "answer": [
            "option.dippindots.4.1.5.1",
            "option.dippindots.4.1.5.3",
            "option.dippindots.4.1.5.4"
        ],
        "keywords": [],
        "next": "RET",
        "position": "snackroom.kni:172:7"
    },
    "option.dippindots.4.1.5.1": {
        "type": "text",
        "text": "You get c",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:172:7"
    },
    "option.dippindots.4.1.5.2": {
        "type": "text",
        "text": "C",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:172:7"
    },
    "option.dippindots.4.1.5.3": {
        "type": "text",
        "text": "ool mint crunch.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:172:7"
    },
    "option.dippindots.4.1.5.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.dippindots.4.1.5.5",
        "position": "snackroom.kni:172:7"
    },
    "option.dippindots.4.1.5.5": {
        "type": "call",
        "label": "taste",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:172:7"
    },
    "option.dippindots.4.2": {
        "type": "goto",
        "next": "RET",
        "position": "snackroom.kni:173:3"
    },
    "taste": {
        "type": "def",
        "locals": [],
        "next": "taste.1",
        "position": "snackroom.kni:175:5"
    },
    "taste.1": {
        "type": "switch",
        "expression": [
            "get",
            "taste.1"
        ],
        "variable": "taste.1",
        "value": 0,
        "mode": "rand",
        "branches": [
            "taste.1.1",
            "taste.1.2",
            "taste.1.3",
            "taste.1.4",
            "taste.1.5",
            "taste.1.6"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:176:5"
    },
    "taste.1.1": {
        "type": "text",
        "text": "Delicious!",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:176:5"
    },
    "taste.1.2": {
        "type": "text",
        "text": "Out of this world!",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:176:5"
    },
    "taste.1.3": {
        "type": "text",
        "text": "You feel like you're in the future.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:176:5"
    },
    "taste.1.4": {
        "type": "text",
        "text": "Zetus Lepetus!",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:176:5"
    },
    "taste.1.5": {
        "type": "text",
        "text": "Your brain freezes.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:176:5"
    },
    "taste.1.6": {
        "type": "text",
        "text": "It's fine.",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:176:5"
    },
    "option.healthy": {
        "type": "def",
        "locals": [
            "currency"
        ],
        "next": "option.healthy.1",
        "position": "snackroom.kni:178:3"
    },
    "option.healthy.1": {
        "type": "text",
        "text": "various snacks.",
        "lift": " ",
        "drop": " ",
        "next": "option.healthy.2",
        "position": "snackroom.kni:180:3"
    },
    "option.healthy.2": {
        "type": "call",
        "label": "show.money",
        "args": [
            [
                "get",
                "currency"
            ]
        ],
        "next": "option.healthy.3",
        "branch": "ESC",
        "position": "snackroom.kni:180:3"
    },
    "option.healthy.3": {
        "type": "switch",
        "expression": [
            "not",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ]
        ],
        "variable": null,
        "value": 0,
        "mode": "walk",
        "branches": [
            "option.healthy.3.1",
            "option.healthy.3.2"
        ],
        "weights": [
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:181:3"
    },
    "option.healthy.3.1": {
        "type": "opt",
        "question": [
            "option.healthy.3.1.0.2",
            "option.healthy.3.1.0.3"
        ],
        "answer": [
            "option.healthy.3.1.0.1",
            "option.healthy.3.1.0.3",
            "option.healthy.3.1.0.4"
        ],
        "keywords": [],
        "next": "option.healthy.3.1.1",
        "position": "snackroom.kni:182:7"
    },
    "option.healthy.3.1.0.1": {
        "type": "text",
        "text": "You get the g",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:182:7"
    },
    "option.healthy.3.1.0.2": {
        "type": "text",
        "text": "G",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:182:7"
    },
    "option.healthy.3.1.0.3": {
        "type": "text",
        "text": "ranola bar.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:182:7"
    },
    "option.healthy.3.1.0.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.healthy.3.1.0.5",
        "position": "snackroom.kni:182:7"
    },
    "option.healthy.3.1.0.5": {
        "type": "call",
        "label": "eat",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:182:7"
    },
    "option.healthy.3.1.1": {
        "type": "opt",
        "question": [
            "option.healthy.3.1.1.2",
            "option.healthy.3.1.1.3"
        ],
        "answer": [
            "option.healthy.3.1.1.1",
            "option.healthy.3.1.1.3",
            "option.healthy.3.1.1.4"
        ],
        "keywords": [],
        "next": "option.healthy.3.1.2",
        "position": "snackroom.kni:183:7"
    },
    "option.healthy.3.1.1.1": {
        "type": "text",
        "text": "You get the t",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:183:7"
    },
    "option.healthy.3.1.1.2": {
        "type": "text",
        "text": "T",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:183:7"
    },
    "option.healthy.3.1.1.3": {
        "type": "text",
        "text": "rail mix.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:183:7"
    },
    "option.healthy.3.1.1.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.healthy.3.1.1.5",
        "position": "snackroom.kni:183:7"
    },
    "option.healthy.3.1.1.5": {
        "type": "call",
        "label": "eat",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:183:7"
    },
    "option.healthy.3.1.2": {
        "type": "opt",
        "question": [
            "option.healthy.3.1.2.2",
            "option.healthy.3.1.2.3"
        ],
        "answer": [
            "option.healthy.3.1.2.1",
            "option.healthy.3.1.2.3",
            "option.healthy.3.1.2.4"
        ],
        "keywords": [],
        "next": "option.healthy.3.1.3",
        "position": "snackroom.kni:184:7"
    },
    "option.healthy.3.1.2.1": {
        "type": "text",
        "text": "You get the f",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:184:7"
    },
    "option.healthy.3.1.2.2": {
        "type": "text",
        "text": "F",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:184:7"
    },
    "option.healthy.3.1.2.3": {
        "type": "text",
        "text": "reeze dried berries.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:184:7"
    },
    "option.healthy.3.1.2.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.healthy.3.1.2.5",
        "position": "snackroom.kni:184:7"
    },
    "option.healthy.3.1.2.5": {
        "type": "call",
        "label": "eat",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:184:7"
    },
    "option.healthy.3.1.3": {
        "type": "opt",
        "question": [
            "option.healthy.3.1.3.2",
            "option.healthy.3.1.3.3"
        ],
        "answer": [
            "option.healthy.3.1.3.1",
            "option.healthy.3.1.3.3",
            "option.healthy.3.1.3.4"
        ],
        "keywords": [],
        "next": "option.healthy.3.1.4",
        "position": "snackroom.kni:185:7"
    },
    "option.healthy.3.1.3.1": {
        "type": "text",
        "text": "You get the k",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:185:7"
    },
    "option.healthy.3.1.3.2": {
        "type": "text",
        "text": "K",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:185:7"
    },
    "option.healthy.3.1.3.3": {
        "type": "text",
        "text": "ale chips.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:185:7"
    },
    "option.healthy.3.1.3.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.healthy.3.1.3.5",
        "position": "snackroom.kni:185:7"
    },
    "option.healthy.3.1.3.5": {
        "type": "call",
        "label": "eat",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:185:7"
    },
    "option.healthy.3.1.4": {
        "type": "opt",
        "question": [
            "option.healthy.3.1.4.2",
            "option.healthy.3.1.4.3"
        ],
        "answer": [
            "option.healthy.3.1.4.1",
            "option.healthy.3.1.4.3",
            "option.healthy.3.1.4.4"
        ],
        "keywords": [],
        "next": "option.healthy.3.1.5",
        "position": "snackroom.kni:186:7"
    },
    "option.healthy.3.1.4.1": {
        "type": "text",
        "text": "You get the r",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:186:7"
    },
    "option.healthy.3.1.4.2": {
        "type": "text",
        "text": "R",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:186:7"
    },
    "option.healthy.3.1.4.3": {
        "type": "text",
        "text": "ice puffs.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:186:7"
    },
    "option.healthy.3.1.4.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.healthy.3.1.4.5",
        "position": "snackroom.kni:186:7"
    },
    "option.healthy.3.1.4.5": {
        "type": "call",
        "label": "eat",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:186:7"
    },
    "option.healthy.3.1.5": {
        "type": "opt",
        "question": [
            "option.healthy.3.1.5.2",
            "option.healthy.3.1.5.3"
        ],
        "answer": [
            "option.healthy.3.1.5.1",
            "option.healthy.3.1.5.3",
            "option.healthy.3.1.5.4"
        ],
        "keywords": [],
        "next": "option.healthy.3.1.6",
        "position": "snackroom.kni:187:7"
    },
    "option.healthy.3.1.5.1": {
        "type": "text",
        "text": "You get the p",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:187:7"
    },
    "option.healthy.3.1.5.2": {
        "type": "text",
        "text": "P",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:187:7"
    },
    "option.healthy.3.1.5.3": {
        "type": "text",
        "text": "armesan crisps.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:187:7"
    },
    "option.healthy.3.1.5.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.healthy.3.1.5.5",
        "position": "snackroom.kni:187:7"
    },
    "option.healthy.3.1.5.5": {
        "type": "call",
        "label": "eat",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:187:7"
    },
    "option.healthy.3.1.6": {
        "type": "opt",
        "question": [
            "option.healthy.3.1.6.2",
            "option.healthy.3.1.6.3"
        ],
        "answer": [
            "option.healthy.3.1.6.1",
            "option.healthy.3.1.6.3",
            "option.healthy.3.1.6.4"
        ],
        "keywords": [],
        "next": "RET",
        "position": "snackroom.kni:188:7"
    },
    "option.healthy.3.1.6.1": {
        "type": "text",
        "text": "You get the c",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:188:7"
    },
    "option.healthy.3.1.6.2": {
        "type": "text",
        "text": "C",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:188:7"
    },
    "option.healthy.3.1.6.3": {
        "type": "text",
        "text": "hia pudding.",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:188:7"
    },
    "option.healthy.3.1.6.4": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.healthy.3.1.6.5",
        "position": "snackroom.kni:188:7"
    },
    "option.healthy.3.1.6.5": {
        "type": "call",
        "label": "eat",
        "args": [],
        "next": "RET",
        "branch": "ESC",
        "position": "snackroom.kni:188:7"
    },
    "option.healthy.3.2": {
        "type": "goto",
        "next": "RET",
        "position": "snackroom.kni:189:3"
    },
    "eat.1.6": {
        "type": "text",
        "text": "Yum?",
        "lift": "",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:199:5"
    },
    "option.money": {
        "type": "def",
        "locals": [
            "currency"
        ],
        "next": "option.money.1",
        "position": "snackroom.kni:201:3"
    },
    "option.money.1": {
        "type": "text",
        "text": "synthesizing currency.",
        "lift": " ",
        "drop": " ",
        "next": "option.money.2",
        "position": "snackroom.kni:202:3"
    },
    "option.money.2": {
        "type": "par",
        "next": "option.money.3",
        "position": "snackroom.kni:202:3"
    },
    "option.money.3": {
        "type": "text",
        "text": "This machine takes",
        "lift": " ",
        "drop": " ",
        "next": "option.money.4",
        "position": "snackroom.kni:203:3"
    },
    "option.money.4": {
        "type": "switch",
        "expression": [
            "get",
            "currency"
        ],
        "variable": null,
        "value": 0,
        "mode": "walk",
        "branches": [
            "option.money.4.1",
            "option.money.4.2",
            "option.money.4.3"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:203:3"
    },
    "option.money.4.1": {
        "type": "text",
        "text": "gold dubloons",
        "lift": "",
        "drop": "",
        "next": "option.money.5",
        "position": "snackroom.kni:203:3"
    },
    "option.money.4.2": {
        "type": "text",
        "text": "gemstones",
        "lift": "",
        "drop": "",
        "next": "option.money.5",
        "position": "snackroom.kni:203:3"
    },
    "option.money.4.3": {
        "type": "text",
        "text": "quarters",
        "lift": "",
        "drop": "",
        "next": "option.money.5",
        "position": "snackroom.kni:203:3"
    },
    "option.money.5": {
        "type": "text",
        "text": ". You have",
        "lift": "",
        "drop": " ",
        "next": "option.money.6",
        "position": "snackroom.kni:203:3"
    },
    "option.money.6": {
        "type": "echo",
        "expression": [
            "get",
            "currency.0"
        ],
        "lift": "",
        "drop": "",
        "next": "option.money.7",
        "position": "snackroom.kni:203:3"
    },
    "option.money.7": {
        "type": "text",
        "text": "gold dubloons,",
        "lift": " ",
        "drop": " ",
        "next": "option.money.8",
        "position": "snackroom.kni:203:3"
    },
    "option.money.8": {
        "type": "echo",
        "expression": [
            "get",
            "currency.1"
        ],
        "lift": "",
        "drop": "",
        "next": "option.money.9",
        "position": "snackroom.kni:203:3"
    },
    "option.money.9": {
        "type": "text",
        "text": "small gemstones, and",
        "lift": " ",
        "drop": " ",
        "next": "option.money.10",
        "position": "snackroom.kni:203:3"
    },
    "option.money.10": {
        "type": "echo",
        "expression": [
            "get",
            "currency.2"
        ],
        "lift": "",
        "drop": "",
        "next": "option.money.11",
        "position": "snackroom.kni:203:3"
    },
    "option.money.11": {
        "type": "text",
        "text": "quarters.",
        "lift": " ",
        "drop": " ",
        "next": "option.money.12",
        "position": "snackroom.kni:203:3"
    },
    "option.money.12": {
        "type": "par",
        "next": "option.money.13",
        "position": "snackroom.kni:203:3"
    },
    "option.money.13": {
        "type": "switch",
        "expression": [
            "not",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ]
        ],
        "variable": null,
        "value": 0,
        "mode": "walk",
        "branches": [
            "option.money.13.1",
            "option.money.13.2"
        ],
        "weights": [
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:204:3"
    },
    "option.money.13.1": {
        "type": "opt",
        "question": [
            "option.money.13.1.0.4",
            "option.money.13.1.0.5"
        ],
        "answer": [
            "option.money.13.1.0.1",
            "option.money.13.1.0.5",
            "option.money.13.1.0.6"
        ],
        "keywords": [],
        "next": "option.money.13.1.1",
        "position": "snackroom.kni:205:7"
    },
    "option.money.13.1.0.1": {
        "type": "text",
        "text": "You insert one (1)",
        "lift": "",
        "drop": " ",
        "next": "option.money.13.1.0.2",
        "position": "snackroom.kni:205:7"
    },
    "option.money.13.1.0.2": {
        "type": "switch",
        "expression": [
            "get",
            "currency"
        ],
        "variable": null,
        "value": 0,
        "mode": "walk",
        "branches": [
            "option.money.13.1.0.2.1",
            "option.money.13.1.0.2.2",
            "option.money.13.1.0.2.3"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:205:7"
    },
    "option.money.13.1.0.2.1": {
        "type": "text",
        "text": "dubloon",
        "lift": "",
        "drop": "",
        "next": "option.money.13.1.0.3",
        "position": "snackroom.kni:205:7"
    },
    "option.money.13.1.0.2.2": {
        "type": "text",
        "text": "gemstone",
        "lift": "",
        "drop": "",
        "next": "option.money.13.1.0.3",
        "position": "snackroom.kni:205:7"
    },
    "option.money.13.1.0.2.3": {
        "type": "text",
        "text": "quarter",
        "lift": "",
        "drop": "",
        "next": "option.money.13.1.0.3",
        "position": "snackroom.kni:205:7"
    },
    "option.money.13.1.0.3": {
        "type": "text",
        "text": "and recieve",
        "lift": " ",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:205:7"
    },
    "option.money.13.1.0.4": {
        "type": "text",
        "text": "Synthesize",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:205:7"
    },
    "option.money.13.1.0.5": {
        "type": "text",
        "text": "three (3) gold dubloons.",
        "lift": " ",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:205:7"
    },
    "option.money.13.1.0.6": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.money.13.1.0.7",
        "position": "snackroom.kni:205:7"
    },
    "option.money.13.1.0.7": {
        "type": "move",
        "source": [
            "+",
            [
                "get",
                "currency.0"
            ],
            [
                "val",
                3
            ]
        ],
        "target": [
            "get",
            "currency.0"
        ],
        "next": "RET",
        "position": "snackroom.kni:205:7"
    },
    "option.money.13.1.1": {
        "type": "opt",
        "question": [
            "option.money.13.1.1.4",
            "option.money.13.1.1.5"
        ],
        "answer": [
            "option.money.13.1.1.1",
            "option.money.13.1.1.5",
            "option.money.13.1.1.6"
        ],
        "keywords": [],
        "next": "option.money.13.1.2",
        "position": "snackroom.kni:206:7"
    },
    "option.money.13.1.1.1": {
        "type": "text",
        "text": "You insert one (1)",
        "lift": "",
        "drop": " ",
        "next": "option.money.13.1.1.2",
        "position": "snackroom.kni:206:7"
    },
    "option.money.13.1.1.2": {
        "type": "switch",
        "expression": [
            "get",
            "currency"
        ],
        "variable": null,
        "value": 0,
        "mode": "walk",
        "branches": [
            "option.money.13.1.1.2.1",
            "option.money.13.1.1.2.2",
            "option.money.13.1.1.2.3"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:206:7"
    },
    "option.money.13.1.1.2.1": {
        "type": "text",
        "text": "dubloon",
        "lift": "",
        "drop": "",
        "next": "option.money.13.1.1.3",
        "position": "snackroom.kni:206:7"
    },
    "option.money.13.1.1.2.2": {
        "type": "text",
        "text": "gemstone",
        "lift": "",
        "drop": "",
        "next": "option.money.13.1.1.3",
        "position": "snackroom.kni:206:7"
    },
    "option.money.13.1.1.2.3": {
        "type": "text",
        "text": "quarter",
        "lift": "",
        "drop": "",
        "next": "option.money.13.1.1.3",
        "position": "snackroom.kni:206:7"
    },
    "option.money.13.1.1.3": {
        "type": "text",
        "text": "and recieve",
        "lift": " ",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:206:7"
    },
    "option.money.13.1.1.4": {
        "type": "text",
        "text": "Synthesize",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:206:7"
    },
    "option.money.13.1.1.5": {
        "type": "text",
        "text": "three (3) gemstones.",
        "lift": " ",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:206:7"
    },
    "option.money.13.1.1.6": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.money.13.1.1.7",
        "position": "snackroom.kni:206:7"
    },
    "option.money.13.1.1.7": {
        "type": "move",
        "source": [
            "+",
            [
                "get",
                "currency.1"
            ],
            [
                "val",
                3
            ]
        ],
        "target": [
            "get",
            "currency.1"
        ],
        "next": "RET",
        "position": "snackroom.kni:206:7"
    },
    "option.money.13.1.2": {
        "type": "opt",
        "question": [
            "option.money.13.1.2.4",
            "option.money.13.1.2.5"
        ],
        "answer": [
            "option.money.13.1.2.1",
            "option.money.13.1.2.5",
            "option.money.13.1.2.6"
        ],
        "keywords": [],
        "next": "RET",
        "position": "snackroom.kni:207:7"
    },
    "option.money.13.1.2.1": {
        "type": "text",
        "text": "You insert one (1)",
        "lift": "",
        "drop": " ",
        "next": "option.money.13.1.2.2",
        "position": "snackroom.kni:207:7"
    },
    "option.money.13.1.2.2": {
        "type": "switch",
        "expression": [
            "get",
            "currency"
        ],
        "variable": null,
        "value": 0,
        "mode": "walk",
        "branches": [
            "option.money.13.1.2.2.1",
            "option.money.13.1.2.2.2",
            "option.money.13.1.2.2.3"
        ],
        "weights": [
            [
                "val",
                1
            ],
            [
                "val",
                1
            ],
            [
                "val",
                1
            ]
        ],
        "next": "RET",
        "position": "snackroom.kni:207:7"
    },
    "option.money.13.1.2.2.1": {
        "type": "text",
        "text": "dubloon",
        "lift": "",
        "drop": "",
        "next": "option.money.13.1.2.3",
        "position": "snackroom.kni:207:7"
    },
    "option.money.13.1.2.2.2": {
        "type": "text",
        "text": "gemstone",
        "lift": "",
        "drop": "",
        "next": "option.money.13.1.2.3",
        "position": "snackroom.kni:207:7"
    },
    "option.money.13.1.2.2.3": {
        "type": "text",
        "text": "quarter",
        "lift": "",
        "drop": "",
        "next": "option.money.13.1.2.3",
        "position": "snackroom.kni:207:7"
    },
    "option.money.13.1.2.3": {
        "type": "text",
        "text": "and recieve",
        "lift": " ",
        "drop": " ",
        "next": "RET",
        "position": "snackroom.kni:207:7"
    },
    "option.money.13.1.2.4": {
        "type": "text",
        "text": "Synthesize",
        "lift": "",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:207:7"
    },
    "option.money.13.1.2.5": {
        "type": "text",
        "text": "three (3) quarters.",
        "lift": " ",
        "drop": "",
        "next": "RET",
        "position": "snackroom.kni:207:7"
    },
    "option.money.13.1.2.6": {
        "type": "move",
        "source": [
            "-",
            [
                "var",
                [
                    "currency.",
                    ""
                ],
                [
                    [
                        "get",
                        "currency"
                    ]
                ]
            ],
            [
                "val",
                1
            ]
        ],
        "target": [
            "var",
            [
                "currency.",
                ""
            ],
            [
                [
                    "get",
                    "currency"
                ]
            ]
        ],
        "next": "option.money.13.1.2.7",
        "position": "snackroom.kni:207:7"
    },
    "option.money.13.1.2.7": {
        "type": "move",
        "source": [
            "+",
            [
                "get",
                "currency.2"
            ],
            [
                "val",
                3
            ]
        ],
        "target": [
            "get",
            "currency.2"
        ],
        "next": "RET",
        "position": "snackroom.kni:207:7"
    },
    "option.money.13.2": {
        "type": "goto",
        "next": "RET",
        "position": "snackroom.kni:208:3"
    }
}
}],["template.js","kni","template.js",{"./engine":2,"./story.json":6,"./story":5,"./document":1},function (require, exports, module, __filename, __dirname){

// kni/template.js
// ---------------

'use strict';
var Engine = require('./engine');
var story = require('./story.json');
var Story = require('./story');
var Document = require('./document');

var reset = document.querySelector(".reset");
reset.onclick = function onclick() {
    engine.reset();
};

var doc = new Document(document.body);
var engine = new Engine({
    story: story,
    render: doc,
    dialog: doc,
    handler: {
        waypoint: function waypoint(waypoint) {
            var json = JSON.stringify(waypoint);
            window.history.pushState(waypoint, '', '#' + btoa(json));
            localStorage.setItem('kni', json);
        },
        goto: function _goto(label) {
            console.log(label);
        },
        answer: function answer(text) {
            console.log('>', text);
        }
    }
});

doc.clear();

var waypoint;
var json;
if (waypoint = window.location.hash || null) {
    try {
        waypoint = atob(waypoint.slice(1));
        waypoint = JSON.parse(waypoint);
    } catch (error) {
        console.error(error);
        waypoint = null;
    }
} else if (json = localStorage.getItem('kni')) {
    try {
        waypoint = JSON.parse(json);
    } catch (error) {
        console.error(error);
        waypoint = null;
    }
    window.history.replaceState(waypoint, '', '#' + btoa(json));
}

window.onpopstate = function onpopstate(event) {
    console.log('> back');
    engine.resume(event.state);
};

engine.resume(waypoint);

window.onkeypress = function onkeypress(event) {
    var key = event.code;
    var match = /^Digit(\d+)$/.exec(key);
    if (match) {
        engine.answer(match[1]);
    } else if (key === 'KeyR') {
        engine.reset();
    }
};

}]])("kni/template.js")
        --></script>
    </body>
</html>